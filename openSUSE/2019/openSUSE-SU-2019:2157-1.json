{
	"document_title": "Security update for openldap2",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "openSUSE-SU-2019:2157-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2019-09-23T18:19:38Z",
				"description": "current"
			}
		},
		"initial_release_date": "2019-09-23T18:19:38Z",
		"current_release_date": "2019-09-23T18:19:38Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for openldap2",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for openldap2 fixes the following issues:\n\nSecurity issue fixed:\n\n- CVE-2019-13565: Fixed an authentication bypass when using SASL authentication and session encryption (bsc#1143194).\n- CVE-2019-13057: Fixed an issue with delegated database admin privileges (bsc#1143273).\n- CVE-2017-17740: When both the nops module and the member of overlay\n  are enabled, attempts to free a buffer that was allocated on the stack,\n  which allows remote attackers to cause a denial of service (slapd crash)\n  via a member MODDN operation. (bsc#1073313)\n\nNon-security issues fixed:\n\n- Fixed broken shebang line in openldap_update_modules_path.sh (bsc#1114845).\n- Create files in /var/lib/ldap/ during initial start to allow for transactional updates (bsc#1111388)\n- Fixed incorrect post script call causing tmpfiles creation not to be run (bsc#1111388).\n\nThis update was imported from the SUSE:SLE-15:Update update project.",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "openSUSE-2019-2157",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://lists.opensuse.org/opensuse-security-announce/2019-09/msg00053.html",
			"description": "E-Mail link for openSUSE-SU-2019:2157-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1073313",
			"description": "SUSE Bug 1073313"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1111388",
			"description": "SUSE Bug 1111388"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1114845",
			"description": "SUSE Bug 1114845"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1143194",
			"description": "SUSE Bug 1143194"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1143273",
			"description": "SUSE Bug 1143273"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2017-17740/",
			"description": "SUSE CVE CVE-2017-17740 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2019-13057/",
			"description": "SUSE CVE CVE-2019-13057 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2019-13565/",
			"description": "SUSE CVE CVE-2019-13565 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.1",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.1",
						"full_product_name": {
							"text": "openSUSE Leap 15.1",
							"product_id": "openSUSE Leap 15.1",
							"cpe": "cpe:/o:opensuse:leap:15.1"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "libldap-2_4-2-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "libldap-2_4-2-2.4.46-lp151.10.3.1",
					"product_id": "libldap-2_4-2-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libldap-2_4-2-32bit-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "libldap-2_4-2-32bit-2.4.46-lp151.10.3.1",
					"product_id": "libldap-2_4-2-32bit-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libldap-data-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "libldap-data-2.4.46-lp151.10.3.1",
					"product_id": "libldap-data-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-back-meta-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-back-meta-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-back-meta-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-back-perl-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-back-perl-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-back-perl-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-back-sock-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-back-sock-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-back-sock-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-back-sql-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-back-sql-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-back-sql-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-client-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-client-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-client-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-contrib-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-contrib-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-contrib-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-devel-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-devel-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-devel-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-devel-32bit-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-devel-32bit-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-devel-32bit-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-devel-static-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-devel-static-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-devel-static-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-doc-2.4.46-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-doc-2.4.46-lp151.10.3.1",
					"product_id": "openldap2-doc-2.4.46-lp151.10.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "openldap2-ppolicy-check-password-1.2-lp151.10.3.1",
				"full_product_name": {
					"text": "openldap2-ppolicy-check-password-1.2-lp151.10.3.1",
					"product_id": "openldap2-ppolicy-check-password-1.2-lp151.10.3.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "libldap-2_4-2-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "libldap-2_4-2-32bit-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "libldap-data-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-back-meta-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-back-perl-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-back-sock-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-back-sql-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-client-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-contrib-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-devel-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-devel-32bit-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-devel-static-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-doc-2.4.46-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "openldap2-ppolicy-check-password-1.2-lp151.10.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "contrib/slapd-modules/nops/nops.c in OpenLDAP through 2.4.45, when both the nops module and the memberof overlay are enabled, attempts to free a buffer that was allocated on the stack, which allows remote attackers to cause a denial of service (slapd crash) via a member MODDN operation.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2017-17740",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 15.1:libldap-2_4-2-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:libldap-2_4-2-32bit-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:libldap-data-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-meta-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-perl-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-sock-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-sql-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-client-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-contrib-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-32bit-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-static-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-doc-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-ppolicy-check-password-1.2-lp151.10.3.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:N/I:N/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.9",
					"vector_v_3": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2019-09/msg00053.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2017-17740.html",
					"description": "CVE-2017-17740"
				},
				{
					"url": "https://bugzilla.suse.com/1073313",
					"description": "SUSE Bug 1073313"
				}
			]
		},
		{
			"notes": [
				{
					"text": "An issue was discovered in the server in OpenLDAP before 2.4.48. When the server administrator delegates rootDN (database admin) privileges for certain databases but wants to maintain isolation (e.g., for multi-tenant deployments), slapd does not properly stop a rootDN from requesting authorization as an identity from another database during a SASL bind or with a proxyAuthz (RFC 4370) control. (It is not a common configuration to deploy a system where the server administrator and a DB administrator enjoy different levels of trust.)",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2019-13057",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 15.1:libldap-2_4-2-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:libldap-2_4-2-32bit-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:libldap-data-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-meta-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-perl-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-sock-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-sql-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-client-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-contrib-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-32bit-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-static-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-doc-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-ppolicy-check-password-1.2-lp151.10.3.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "3.5",
					"vector_v_2": "AV:N/AC:M/Au:S/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.3",
					"vector_v_3": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2019-09/msg00053.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2019-13057.html",
					"description": "CVE-2019-13057"
				},
				{
					"url": "https://bugzilla.suse.com/1143273",
					"description": "SUSE Bug 1143273"
				}
			]
		},
		{
			"notes": [
				{
					"text": "An issue was discovered in OpenLDAP 2.x before 2.4.48. When using SASL authentication and session encryption, and relying on the SASL security layers in slapd access controls, it is possible to obtain access that would otherwise be denied via a simple bind for any identity covered in those ACLs. After the first SASL bind is completed, the sasl_ssf value is retained for all new non-SASL connections. Depending on the ACL configuration, this can affect different types of operations (searches, modifications, etc.). In other words, a successful authorization step completed by one user affects the authorization requirement for a different user.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2019-13565",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 15.1:libldap-2_4-2-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:libldap-2_4-2-32bit-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:libldap-data-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-meta-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-perl-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-sock-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-back-sql-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-client-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-contrib-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-32bit-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-devel-static-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-doc-2.4.46-lp151.10.3.1",
						"openSUSE Leap 15.1:openldap2-ppolicy-check-password-1.2-lp151.10.3.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.5",
					"vector_v_3": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2019-09/msg00053.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2019-13565.html",
					"description": "CVE-2019-13565"
				},
				{
					"url": "https://bugzilla.suse.com/1143194",
					"description": "SUSE Bug 1143194"
				}
			]
		}
	]
}
