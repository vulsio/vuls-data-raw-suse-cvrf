{
	"document_title": "Security update for salt",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "openSUSE-SU-2020:0357-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2020-03-18T15:18:47Z",
				"description": "current"
			}
		},
		"initial_release_date": "2020-03-18T15:18:47Z",
		"current_release_date": "2020-03-18T15:18:47Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for salt",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for salt fixes the following issues:\n\n- Avoid possible user escalation upgrading salt-master (bsc#1157465) (CVE-2019-18897)\n- Fix unit tests failures in test_batch_async tests\n- Batch Async: Handle exceptions, properly unregister and close instances after\n  running async batching to avoid CPU starvation of the MWorkers (bsc#1162327)\n- RHEL/CentOS 8 uses platform-python instead of python3\n- New configuration option for selection of grains in the minion start event.\n- Fix 'os_family' grain for Astra Linux Common Edition\n- Fix for salt-api NET API where unauthenticated attacker could run\n  arbitrary code (CVE-2019-17361) (bsc#1162504)\n- Adds disabled parameter to mod_repo in aptpkg module\n  Move token with atomic operation\n  Bad API token files get deleted (bsc#1160931)\n- Support for Btrfs and XFS in parted and mkfs added\n- Adds list_downloaded for apt Module to enable pre-downloading support\n  Adds virt.(pool|network)_get_xml functions\n- Various libvirt updates:\n  * Add virt.pool_capabilities function\n  * virt.pool_running improvements\n  * Add virt.pool_deleted state\n  * virt.network_define allow adding IP configuration\n- virt: adding kernel boot parameters to libvirt xml\n- Fix to scheduler when data['run'] does not exist (bsc#1159118)\n- Fix virt states to not fail on VMs already stopped\n- Fix applying of attributes for returner rawfile_json (bsc#1158940)\n- xfs: do not fail if type is not present (bsc#1153611)\n- Fix errors when running virt.get_hypervisor function\n- Align virt.full_info fixes with upstream Salt\n- Fix for log checking in x509 test\n- Read repo info without using interpolation (bsc#1135656)\n- Limiting M2Crypto to >= SLE15\n- Replacing pycrypto with M2Crypto (bsc#1165425)\n\nThis update was imported from the SUSE:SLE-15-SP1:Update update project.",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "openSUSE-2020-357",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://lists.opensuse.org/opensuse-security-announce/2020-03/msg00026.html",
			"description": "E-Mail link for openSUSE-SU-2020:0357-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1135656",
			"description": "SUSE Bug 1135656"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1153611",
			"description": "SUSE Bug 1153611"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1157465",
			"description": "SUSE Bug 1157465"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1158940",
			"description": "SUSE Bug 1158940"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1159118",
			"description": "SUSE Bug 1159118"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1160931",
			"description": "SUSE Bug 1160931"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1162327",
			"description": "SUSE Bug 1162327"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1162504",
			"description": "SUSE Bug 1162504"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1165425",
			"description": "SUSE Bug 1165425"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2019-17361/",
			"description": "SUSE CVE CVE-2019-17361 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2019-18897/",
			"description": "SUSE CVE CVE-2019-18897 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.1",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.1",
						"full_product_name": {
							"text": "openSUSE Leap 15.1",
							"product_id": "openSUSE Leap 15.1",
							"cpe": "cpe:/o:opensuse:leap:15.1"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "python2-salt-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "python2-salt-2019.2.0-lp151.5.12.1",
					"product_id": "python2-salt-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-salt-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "python3-salt-2019.2.0-lp151.5.12.1",
					"product_id": "python3-salt-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-2019.2.0-lp151.5.12.1",
					"product_id": "salt-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-api-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-api-2019.2.0-lp151.5.12.1",
					"product_id": "salt-api-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-bash-completion-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-bash-completion-2019.2.0-lp151.5.12.1",
					"product_id": "salt-bash-completion-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-cloud-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-cloud-2019.2.0-lp151.5.12.1",
					"product_id": "salt-cloud-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-doc-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-doc-2019.2.0-lp151.5.12.1",
					"product_id": "salt-doc-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-fish-completion-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-fish-completion-2019.2.0-lp151.5.12.1",
					"product_id": "salt-fish-completion-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-master-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-master-2019.2.0-lp151.5.12.1",
					"product_id": "salt-master-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-minion-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-minion-2019.2.0-lp151.5.12.1",
					"product_id": "salt-minion-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-proxy-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-proxy-2019.2.0-lp151.5.12.1",
					"product_id": "salt-proxy-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-ssh-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-ssh-2019.2.0-lp151.5.12.1",
					"product_id": "salt-ssh-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-standalone-formulas-configuration-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-standalone-formulas-configuration-2019.2.0-lp151.5.12.1",
					"product_id": "salt-standalone-formulas-configuration-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-syndic-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-syndic-2019.2.0-lp151.5.12.1",
					"product_id": "salt-syndic-2019.2.0-lp151.5.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-zsh-completion-2019.2.0-lp151.5.12.1",
				"full_product_name": {
					"text": "salt-zsh-completion-2019.2.0-lp151.5.12.1",
					"product_id": "salt-zsh-completion-2019.2.0-lp151.5.12.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "python2-salt-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "python3-salt-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-api-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-bash-completion-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-cloud-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-doc-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-fish-completion-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-master-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-minion-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-proxy-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-ssh-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-standalone-formulas-configuration-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-syndic-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			},
			{
				"product_reference": "salt-zsh-completion-2019.2.0-lp151.5.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.1"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "In SaltStack Salt through 2019.2.0, the salt-api NET API with the ssh client enabled is vulnerable to command injection. This allows an unauthenticated attacker with network access to the API endpoint to execute arbitrary code on the salt-api host.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2019-17361",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 15.1:python2-salt-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:python3-salt-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-api-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-bash-completion-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-cloud-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-doc-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-fish-completion-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-master-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-minion-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-proxy-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-ssh-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-standalone-formulas-configuration-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-syndic-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-zsh-completion-2019.2.0-lp151.5.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.8",
					"vector_v_2": "AV:N/AC:M/Au:N/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "8.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2020-03/msg00026.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2019-17361.html",
					"description": "CVE-2019-17361"
				},
				{
					"url": "https://bugzilla.suse.com/1162504",
					"description": "SUSE Bug 1162504"
				}
			]
		},
		{
			"notes": [
				{
					"text": "A UNIX Symbolic Link (Symlink) Following vulnerability in the packaging of salt of SUSE Linux Enterprise Server 12, SUSE Linux Enterprise Server 15; openSUSE Factory allows local attackers to escalate privileges from user salt to root. This issue affects: SUSE Linux Enterprise Server 12 salt-master version 2019.2.0-46.83.1 and prior versions. SUSE Linux Enterprise Server 15 salt-master version 2019.2.0-6.21.1 and prior versions. openSUSE Factory salt-master version 2019.2.2-3.1 and prior versions.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2019-18897",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 15.1:python2-salt-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:python3-salt-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-api-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-bash-completion-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-cloud-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-doc-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-fish-completion-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-master-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-minion-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-proxy-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-ssh-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-standalone-formulas-configuration-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-syndic-2019.2.0-lp151.5.12.1",
						"openSUSE Leap 15.1:salt-zsh-completion-2019.2.0-lp151.5.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "7.2",
					"vector_v_2": "AV:L/AC:L/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "8.4",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2020-03/msg00026.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2019-18897.html",
					"description": "CVE-2019-18897"
				},
				{
					"url": "https://bugzilla.suse.com/1157465",
					"description": "SUSE Bug 1157465"
				}
			]
		}
	]
}
