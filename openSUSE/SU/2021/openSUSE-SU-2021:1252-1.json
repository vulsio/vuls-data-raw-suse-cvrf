{
	"document_title": "Security update for nextcloud",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "openSUSE-SU-2021:1252-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2021-09-14T09:33:54Z",
				"description": "current"
			}
		},
		"initial_release_date": "2021-09-14T09:33:54Z",
		"current_release_date": "2021-09-14T09:33:54Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for nextcloud",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for nextcloud fixes the following issues:\n\nUpdate to 20.0.12\n\nFixed security issues (boo#1190291):\n\n- CVE-2021-32766 (CWE-209): Generation of Error Message Containing Sensitive Information \n- CVE-2021-32800 (CWE-306): Missing Authentication for Critical Function \n- CVE-2021-32801 (CWE-532): Insertion of Sensitive Information into Log File \n- CVE-2021-32802 (CWE-829): Inclusion of Functionality from Untrusted Control Sphere \n\nChanges\n\n- Bump vue-router from 3.4.3 to 3.4.9 (server#27224)\n- Bump v-click-outside from 3.1.1 to 3.1.2 (server#27232)\n- Bump url-search-params-polyfill from 8.1.0 to 8.1.1 (server#27236)\n- Bump debounce from 1.2.0 to 1.2.1 (server#27646)\n- Bump vue and vue-template-compiler (server#27701)\n- Design fixes to app-settings button (server#27745)\n- Reset checksum when writing files to object store (server#27754)\n- Run s3 tests again (server#27804)\n- Fix in locking cache check (server#27829)\n- Bump dompurify from 2.2.8 to 2.2.9 (server#27836)\n- Make search popup usable on mobile, too (server#27858)\n- Cache images on browser (server#27863)\n- Fix dark theme on public link shares (server#27895)\n- Make user status usable on mobile (server#27897)\n- Do not escape display name in dashboard welcome text (server#27913)\n- Bump moment-timezone from 0.5.31 to 0.5.33 (server#27924)\n- Fix newfileMenu on public page (server#27941)\n- Fix svg icons disapearing in app navigation when text overflows (server#27955)\n- Bump bootstrap from 4.5.2 to 4.5.3 (server#27965)\n- Show registered breadcrumb detail views in breadcrumb menu (server#27970)\n- Fix regression in file sidebar (server#27976)\n- Bump exports-loader from 1.1.0 to 1.1.1 (server#27984)\n- Bump @nextcloud/capabilities from 1.0.2 to 1.0.4 (server#27985)\n- Bump @nextcloud/vue-dashboard from 1.0.0 to 1.0.1 (server#27988)\n- Improve notcreatable permissions hint (server#28006)\n- Update CRL due to revoked twofactor_nextcloud_notification.crt (server#28018)\n- Bump sass-loader from 10.0.2 to 10.0.5 (server#28032)\n- Increase footer height for longer menus (server#28045)\n- Mask password for Redis and RedisCluster on connection failure (server#28054)\n- Fix missing theming for login button (server#28065)\n- Fix overlapping of elements in certain views (server#28072)\n- Disable HEIC image preview provider for performance concerns (server#28081)\n- Improve provider check (server#28087)\n- Sanitize more functions from the encryption app (server#28091)\n- Hide download button for public preview of audio files (server#28096)\n- L10n: HTTP in capital letters (server#28107)\n- Fix dark theme in file exists dialog (server#28111)\n- Let memory limit set in tests fit the used amount (server#28125)\n- User management - Add icon to user groups (server#28172)\n- Bump marked from 1.1.1 to 1.1.2 (server#28187)\n- Fix variable override in file view (server#28191)\n- Bump regenerator-runtime from 0.13.7 to 0.13.9 (server#28207)\n- Bump url-loader from 4.1.0 to 4.1.1 (server#28208)\n- Fix Files breadcrumbs being hidden even if there is enough space (server#28224)\n- Dont apply jail search filter is on the root (server#28241)\n- Check that php was compiled with argon2 support or that the php-sodium extensions is installed (server#28289)\n- Fix preference name when generating notifications (activity#603)\n- Fix monochrome icon detection for correct dark mode invert (activity#607)\n- Fix 'Enable notification emails' (activity#613)\n- Show add, del and restored files within by and self filter (activity#616)\n- Link from app-navigation-settings to personal settings (activity#625)\n- Fix pdfviewer design (files_pdfviewer#446)\n- Include version number in firstrunwizard (firstrunwizard#570)\n- Use notification main link if no parameter has a link (notifications#1040)\n- Bump sass-loader from 10.1.0 to 10.1.1 (text#1360)\n- Bump @babel/plugin-transform-runtime from 7.13.9 to 7.13.15 (text#1548)\n- Bump @babel/preset-env from 7.13.9 to 7.13.15 (text#1550)\n- Bump vue-loader from 15.9.6 to 15.9.7 (text#1592)\n- Unify error responses and add logging where appropriate (text#1719)\n- Disable header timeout on mobile (viewer#978)\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "openSUSE-2021-1252",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/5PSLXDEBLEPENTY4PS62BFVL7QHFQ2RC/",
			"description": "E-Mail link for openSUSE-SU-2021:1252-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1190291",
			"description": "SUSE Bug 1190291"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-32766/",
			"description": "SUSE CVE CVE-2021-32766 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-32800/",
			"description": "SUSE CVE CVE-2021-32800 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-32801/",
			"description": "SUSE CVE CVE-2021-32801 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-32802/",
			"description": "SUSE CVE CVE-2021-32802 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Package Hub 12",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Package Hub 12",
						"full_product_name": {
							"text": "SUSE Package Hub 12",
							"product_id": "SUSE Package Hub 12",
							"cpe": "cpe:/o:suse:packagehub:12"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "nextcloud-20.0.12-31.1",
				"full_product_name": {
					"text": "nextcloud-20.0.12-31.1",
					"product_id": "nextcloud-20.0.12-31.1"
				}
			},
			{
				"type": "Product Version",
				"name": "nextcloud-apache-20.0.12-31.1",
				"full_product_name": {
					"text": "nextcloud-apache-20.0.12-31.1",
					"product_id": "nextcloud-apache-20.0.12-31.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "nextcloud-20.0.12-31.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Package Hub 12"
			},
			{
				"product_reference": "nextcloud-apache-20.0.12-31.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Package Hub 12"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "Nextcloud Text is an open source plaintext editing application which ships with the nextcloud server. In affected versions the Nextcloud Text application returned different error messages depending on whether a folder existed in a public link share. This is problematic in case the public link share has been created with \"Upload Only\" privileges. (aka \"File Drop\"). A link share recipient is not expected to see which folders or files exist in a \"File Drop\" share. Using this vulnerability an attacker is able to enumerate folders in such a share. Exploitation requires that the attacker has access to a valid affected \"File Drop\" link share. It is recommended that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.0.1. Users who are unable to upgrade are advised to disable the Nextcloud Text application in the app settings.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-32766",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Package Hub 12:nextcloud-20.0.12-31.1",
						"SUSE Package Hub 12:nextcloud-apache-20.0.12-31.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/5PSLXDEBLEPENTY4PS62BFVL7QHFQ2RC/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-32766.html",
					"description": "CVE-2021-32766"
				},
				{
					"url": "https://bugzilla.suse.com/1190291",
					"description": "SUSE Bug 1190291"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Nextcloud server is an open source, self hosted personal cloud. In affected versions an attacker is able to bypass Two Factor Authentication in Nextcloud. Thus knowledge of a password, or access to a WebAuthN trusted device of a user was sufficient to gain access to an account. It is recommended that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.1.0. There are no workaround for this vulnerability.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-32800",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Package Hub 12:nextcloud-20.0.12-31.1",
						"SUSE Package Hub 12:nextcloud-apache-20.0.12-31.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.4",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "8.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/5PSLXDEBLEPENTY4PS62BFVL7QHFQ2RC/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-32800.html",
					"description": "CVE-2021-32800"
				},
				{
					"url": "https://bugzilla.suse.com/1190291",
					"description": "SUSE Bug 1190291"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Nextcloud server is an open source, self hosted personal cloud. In affected versions logging of exceptions may have resulted in logging potentially sensitive key material for the Nextcloud Encryption-at-Rest functionality. It is recommended that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.1.0. If upgrading is not an option users are advised to disable system logging to resolve this issue until such time that an upgrade can be performed Note that ff you do not use the Encryption-at-Rest functionality of Nextcloud you are not affected by this bug.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-32801",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Package Hub 12:nextcloud-20.0.12-31.1",
						"SUSE Package Hub 12:nextcloud-apache-20.0.12-31.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "2.1",
					"vector_v_2": "AV:L/AC:L/Au:N/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.5",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/5PSLXDEBLEPENTY4PS62BFVL7QHFQ2RC/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-32801.html",
					"description": "CVE-2021-32801"
				},
				{
					"url": "https://bugzilla.suse.com/1190291",
					"description": "SUSE Bug 1190291"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Nextcloud server is an open source, self hosted personal cloud. Nextcloud supports rendering image previews for user provided file content. For some image types, the Nextcloud server was invoking a third-party library that wasn't suited for untrusted user-supplied content. There are several security concerns with passing user-generated content to this library, such as Server-Side-Request-Forgery, file disclosure or potentially executing code on the system. The risk depends on your system configuration and the installed library version. It is recommended that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.1.0. These versions do not use this library anymore. As a workaround users may disable previews by setting `enable_previews` to `false` in `config.php`.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-32802",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Package Hub 12:nextcloud-20.0.12-31.1",
						"SUSE Package Hub 12:nextcloud-apache-20.0.12-31.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "10",
					"vector_v_2": "AV:N/AC:L/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "9.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/5PSLXDEBLEPENTY4PS62BFVL7QHFQ2RC/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-32802.html",
					"description": "CVE-2021-32802"
				},
				{
					"url": "https://bugzilla.suse.com/1190291",
					"description": "SUSE Bug 1190291"
				}
			]
		}
	]
}
