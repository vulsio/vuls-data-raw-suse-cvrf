{
	"document_title": "Security update for tomcat",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "openSUSE-SU-2017:3069-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2017-11-23T17:31:48Z",
				"description": "current"
			}
		},
		"initial_release_date": "2017-11-23T17:31:48Z",
		"current_release_date": "2017-11-23T17:31:48Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for tomcat",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for tomcat fixes the following issues:\n\nSecurity issues fixed:\n\n- CVE-2017-5664: A problem in handling error pages was fixed, to avoid potential file overwrites during error page handling. (bsc#1042910).\n- CVE-2017-7674: A CORS Filter issue could lead to client and server side cache poisoning (bsc#1053352)\n- CVE-2017-12617: A remote code execution possibility via JSP Upload was fixed (bsc#1059554)\n\nNon security bugs fixed:\n\n- Fix tomcat-digest classpath error (bsc#977410) \n- Fix packaged /etc/alternatives symlinks for api libs that caused\n  rpm -V to report link mismatch (bsc#1019016)\n\nThis update was imported from the SUSE:SLE-12-SP2:Update update project.",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://lists.opensuse.org/opensuse-security-announce/2017-11/msg00033.html",
			"description": "E-Mail link for openSUSE-SU-2017:3069-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "openSUSE Leap 42.2",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 42.2",
						"full_product_name": {
							"text": "openSUSE Leap 42.2",
							"product_id": "openSUSE Leap 42.2"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 42.3",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 42.3",
						"full_product_name": {
							"text": "openSUSE Leap 42.3",
							"product_id": "openSUSE Leap 42.3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "tomcat-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-8.0.43-9.1",
					"product_id": "tomcat-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-admin-webapps-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-admin-webapps-8.0.43-9.1",
					"product_id": "tomcat-admin-webapps-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-docs-webapp-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-docs-webapp-8.0.43-9.1",
					"product_id": "tomcat-docs-webapp-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-el-3_0-api-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-el-3_0-api-8.0.43-9.1",
					"product_id": "tomcat-el-3_0-api-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-embed-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-embed-8.0.43-9.1",
					"product_id": "tomcat-embed-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-javadoc-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-javadoc-8.0.43-9.1",
					"product_id": "tomcat-javadoc-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-jsp-2_3-api-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-jsp-2_3-api-8.0.43-9.1",
					"product_id": "tomcat-jsp-2_3-api-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-jsvc-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-jsvc-8.0.43-9.1",
					"product_id": "tomcat-jsvc-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-lib-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-lib-8.0.43-9.1",
					"product_id": "tomcat-lib-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-servlet-3_1-api-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-servlet-3_1-api-8.0.43-9.1",
					"product_id": "tomcat-servlet-3_1-api-8.0.43-9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "tomcat-webapps-8.0.43-9.1",
				"full_product_name": {
					"text": "tomcat-webapps-8.0.43-9.1",
					"product_id": "tomcat-webapps-8.0.43-9.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "tomcat-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-admin-webapps-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-docs-webapp-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-el-3_0-api-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-embed-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-javadoc-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-jsp-2_3-api-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-jsvc-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-lib-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-servlet-3_1-api-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-webapps-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.2"
			},
			{
				"product_reference": "tomcat-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-admin-webapps-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-docs-webapp-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-el-3_0-api-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-embed-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-javadoc-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-jsp-2_3-api-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-jsvc-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-lib-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-servlet-3_1-api-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			},
			{
				"product_reference": "tomcat-webapps-8.0.43-9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 42.3"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "When running Apache Tomcat versions 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81 with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of the Default servlet to false) it was possible to upload a JSP file to the server via a specially crafted request. This JSP could then be requested and any code it contained would be executed by the server.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2017-12617",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 42.2:tomcat-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-admin-webapps-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-docs-webapp-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-el-3_0-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-embed-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-javadoc-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-jsp-2_3-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-jsvc-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-lib-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-servlet-3_1-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-webapps-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-admin-webapps-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-docs-webapp-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-el-3_0-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-embed-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-javadoc-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-jsp-2_3-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-jsvc-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-lib-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-servlet-3_1-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-webapps-8.0.43-9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "9.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "9.8",
					"vector_v_3": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "Please Install the update.",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2017-11/msg00033.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2017-12617.html",
					"description": "CVE-2017-12617"
				},
				{
					"url": "https://bugzilla.suse.com/1059554",
					"description": "SUSE Bug 1059554"
				},
				{
					"url": "https://bugzilla.suse.com/1180947",
					"description": "SUSE Bug 1180947"
				}
			]
		},
		{
			"notes": [
				{
					"text": "The error page mechanism of the Java Servlet Specification requires that, when an error occurs and an error page is configured for the error that occurred, the original request and response are forwarded to the error page. This means that the request is presented to the error page with the original HTTP method. If the error page is a static file, expected behaviour is to serve content of the file as if processing a GET request, regardless of the actual HTTP method. The Default Servlet in Apache Tomcat 9.0.0.M1 to 9.0.0.M20, 8.5.0 to 8.5.14, 8.0.0.RC1 to 8.0.43 and 7.0.0 to 7.0.77 did not do this. Depending on the original request this could lead to unexpected and undesirable results for static error pages including, if the DefaultServlet is configured to permit writes, the replacement or removal of the custom error page. Notes for other user provided error pages: (1) Unless explicitly coded otherwise, JSPs ignore the HTTP method. JSPs used as error pages must must ensure that they handle any error dispatch as a GET request, regardless of the actual method. (2) By default, the response generated by a Servlet does depend on the HTTP method. Custom Servlets used as error pages must ensure that they handle any error dispatch as a GET request, regardless of the actual method.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2017-5664",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 42.2:tomcat-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-admin-webapps-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-docs-webapp-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-el-3_0-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-embed-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-javadoc-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-jsp-2_3-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-jsvc-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-lib-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-servlet-3_1-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-webapps-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-admin-webapps-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-docs-webapp-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-el-3_0-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-embed-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-javadoc-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-jsp-2_3-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-jsvc-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-lib-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-servlet-3_1-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-webapps-8.0.43-9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.5",
					"vector_v_3": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "Please Install the update.",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2017-11/msg00033.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2017-5664.html",
					"description": "CVE-2017-5664"
				},
				{
					"url": "https://bugzilla.suse.com/1042910",
					"description": "SUSE Bug 1042910"
				}
			]
		},
		{
			"notes": [
				{
					"text": "The CORS Filter in Apache Tomcat 9.0.0.M1 to 9.0.0.M21, 8.5.0 to 8.5.15, 8.0.0.RC1 to 8.0.44 and 7.0.41 to 7.0.78 did not add an HTTP Vary header indicating that the response varies depending on Origin. This permitted client and server side cache poisoning in some circumstances.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2017-7674",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Leap 42.2:tomcat-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-admin-webapps-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-docs-webapp-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-el-3_0-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-embed-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-javadoc-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-jsp-2_3-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-jsvc-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-lib-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-servlet-3_1-api-8.0.43-9.1",
						"openSUSE Leap 42.2:tomcat-webapps-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-admin-webapps-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-docs-webapp-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-el-3_0-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-embed-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-javadoc-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-jsp-2_3-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-jsvc-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-lib-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-servlet-3_1-api-8.0.43-9.1",
						"openSUSE Leap 42.3:tomcat-webapps-8.0.43-9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.8",
					"vector_v_2": "AV:N/AC:M/Au:N/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.6",
					"vector_v_3": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "Please Install the update.",
						"lang": "en"
					},
					"url": "https://lists.opensuse.org/opensuse-security-announce/2017-11/msg00033.html"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2017-7674.html",
					"description": "CVE-2017-7674"
				},
				{
					"url": "https://bugzilla.suse.com/1053352",
					"description": "SUSE Bug 1053352"
				}
			]
		}
	]
}
