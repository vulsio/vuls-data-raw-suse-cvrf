{
	"document_title": "Security update for libgit2",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2022:3283-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2022-09-15T13:33:57Z",
				"description": "current"
			}
		},
		"initial_release_date": "2022-09-15T13:33:57Z",
		"current_release_date": "2022-09-15T13:33:57Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for libgit2",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for libgit2 fixes the following issues:\n\n- CVE-2022-24765: Fixed potential command injection via git worktree (bsc#1198234).\n- CVE-2022-29187: Fixed incomplete fix for CVE-2022-24765 (bsc#1201431).\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "SUSE-2022-3283,SUSE-SLE-Module-Development-Tools-15-SP4-2022-3283,openSUSE-SLE-15.4-2022-3283",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223283-1/",
			"description": "Link for SUSE-SU-2022:3283-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012252.html",
			"description": "E-Mail link for SUSE-SU-2022:3283-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1198234",
			"description": "SUSE Bug 1198234"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1201431",
			"description": "SUSE Bug 1201431"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-24765/",
			"description": "SUSE CVE CVE-2022-24765 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-29187/",
			"description": "SUSE CVE CVE-2022-29187 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Module for Development Tools 15 SP4",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Development Tools 15 SP4",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Development Tools 15 SP4",
							"product_id": "SUSE Linux Enterprise Module for Development Tools 15 SP4",
							"cpe": "cpe:/o:suse:sle-module-development-tools:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.4",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.4",
						"full_product_name": {
							"text": "openSUSE Leap 15.4",
							"product_id": "openSUSE Leap 15.4",
							"cpe": "cpe:/o:opensuse:leap:15.4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "libgit2-1_3-1.3.0-150400.3.3.1",
				"full_product_name": {
					"text": "libgit2-1_3-1.3.0-150400.3.3.1",
					"product_id": "libgit2-1_3-1.3.0-150400.3.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libgit2-1_3-32bit-1.3.0-150400.3.3.1",
				"full_product_name": {
					"text": "libgit2-1_3-32bit-1.3.0-150400.3.3.1",
					"product_id": "libgit2-1_3-32bit-1.3.0-150400.3.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libgit2-1_3-64bit-1.3.0-150400.3.3.1",
				"full_product_name": {
					"text": "libgit2-1_3-64bit-1.3.0-150400.3.3.1",
					"product_id": "libgit2-1_3-64bit-1.3.0-150400.3.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libgit2-devel-1.3.0-150400.3.3.1",
				"full_product_name": {
					"text": "libgit2-devel-1.3.0-150400.3.3.1",
					"product_id": "libgit2-devel-1.3.0-150400.3.3.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "libgit2-1_3-1.3.0-150400.3.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Development Tools 15 SP4"
			},
			{
				"product_reference": "libgit2-devel-1.3.0-150400.3.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Development Tools 15 SP4"
			},
			{
				"product_reference": "libgit2-1_3-1.3.0-150400.3.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			},
			{
				"product_reference": "libgit2-1_3-32bit-1.3.0-150400.3.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			},
			{
				"product_reference": "libgit2-devel-1.3.0-150400.3.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "Git for Windows is a fork of Git containing Windows-specific patches. This vulnerability affects users working on multi-user machines, where untrusted parties have write access to the same hard disk. Those untrusted parties could create the folder `C:\\.git`, which would be picked up by Git operations run supposedly outside a repository while searching for a Git directory. Git would then respect any config in said Git directory. Git Bash users who set `GIT_PS1_SHOWDIRTYSTATE` are vulnerable as well. Users who installed posh-gitare vulnerable simply by starting a PowerShell. Users of IDEs such as Visual Studio are vulnerable: simply creating a new project would already read and respect the config specified in `C:\\.git\\config`. Users of the Microsoft fork of Git are vulnerable simply by starting a Git Bash. The problem has been patched in Git for Windows v2.35.2. Users unable to upgrade may create the folder `.git` on all drives where Git commands are run, and remove read/write access from those folders as a workaround. Alternatively, define or extend `GIT_CEILING_DIRECTORIES` to cover the _parent_ directory of the user profile, e.g. `C:\\Users` if the user profile is located in `C:\\Users\\my-user-name`.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-24765",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Module for Development Tools 15 SP4:libgit2-1_3-1.3.0-150400.3.3.1",
						"SUSE Linux Enterprise Module for Development Tools 15 SP4:libgit2-devel-1.3.0-150400.3.3.1",
						"openSUSE Leap 15.4:libgit2-1_3-1.3.0-150400.3.3.1",
						"openSUSE Leap 15.4:libgit2-1_3-32bit-1.3.0-150400.3.3.1",
						"openSUSE Leap 15.4:libgit2-devel-1.3.0-150400.3.3.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.9",
					"vector_v_2": "AV:L/AC:M/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.3",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223283-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-24765.html",
					"description": "CVE-2022-24765"
				},
				{
					"url": "https://bugzilla.suse.com/1198234",
					"description": "SUSE Bug 1198234"
				},
				{
					"url": "https://bugzilla.suse.com/1199109",
					"description": "SUSE Bug 1199109"
				},
				{
					"url": "https://bugzilla.suse.com/1200119",
					"description": "SUSE Bug 1200119"
				},
				{
					"url": "https://bugzilla.suse.com/1200201",
					"description": "SUSE Bug 1200201"
				},
				{
					"url": "https://bugzilla.suse.com/1201431",
					"description": "SUSE Bug 1201431"
				},
				{
					"url": "https://bugzilla.suse.com/1201794",
					"description": "SUSE Bug 1201794"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Git is a distributed revision control system. Git prior to versions 2.37.1, 2.36.2, 2.35.4, 2.34.4, 2.33.4, 2.32.3, 2.31.4, and 2.30.5, is vulnerable to privilege escalation in all platforms. An unsuspecting user could still be affected by the issue reported in CVE-2022-24765, for example when navigating as root into a shared tmp directory that is owned by them, but where an attacker could create a git repository. Versions 2.37.1, 2.36.2, 2.35.4, 2.34.4, 2.33.4, 2.32.3, 2.31.4, and 2.30.5 contain a patch for this issue. The simplest way to avoid being affected by the exploit described in the example is to avoid running git as root (or an Administrator in Windows), and if needed to reduce its use to a minimum. While a generic workaround is not possible, a system could be hardened from the exploit described in the example by removing any such repository if it exists already and creating one as root to block any future attacks.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-29187",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Module for Development Tools 15 SP4:libgit2-1_3-1.3.0-150400.3.3.1",
						"SUSE Linux Enterprise Module for Development Tools 15 SP4:libgit2-devel-1.3.0-150400.3.3.1",
						"openSUSE Leap 15.4:libgit2-1_3-1.3.0-150400.3.3.1",
						"openSUSE Leap 15.4:libgit2-1_3-32bit-1.3.0-150400.3.3.1",
						"openSUSE Leap 15.4:libgit2-devel-1.3.0-150400.3.3.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.9",
					"vector_v_2": "AV:L/AC:M/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.3",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223283-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-29187.html",
					"description": "CVE-2022-29187"
				},
				{
					"url": "https://bugzilla.suse.com/1201431",
					"description": "SUSE Bug 1201431"
				},
				{
					"url": "https://bugzilla.suse.com/1201794",
					"description": "SUSE Bug 1201794"
				},
				{
					"url": "https://bugzilla.suse.com/1203448",
					"description": "SUSE Bug 1203448"
				}
			]
		}
	]
}
