{
	"document_title": "Security update for grafana",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2022:3676-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2022-10-20T11:40:04Z",
				"description": "current"
			}
		},
		"initial_release_date": "2022-10-20T11:40:04Z",
		"current_release_date": "2022-10-20T11:40:04Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for grafana",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for grafana fixes the following issues:\n\nUpdated to version 8.5.13 (jsc#PED-2145, jsc#SLE-23439, jsc#SLE-23422, jsc#SLE-24565):    \n    \n- CVE-2022-36062: Fixed RBAC folders/dashboards privilege escalation (bsc#1203596).    \n- CVE-2022-35957: Fixed escalation from admin to server admin when auth proxy is used (bsc#1203597).    \n- CVE-2022-31107: Fixed OAuth account takeover (bsc#1201539).     \n- CVE-2022-31097: Fixed XSS vulnerability in the Unified Alerting (bsc#1201535).    \n- CVE-2022-21702: Fixed XSS vulnerability in handling data sources (bsc#1195726).    \n- CVE-2022-21703: Fixed cross-origin request forgery vulnerability (bsc#1195727).    \n- CVE-2022-21713: Fixed Insecure Direct Object Reference vulnerability in Teams API (bsc#1195728).    \n- CVE-2022-21673: Fixed missing error return in GetUserInfo if no user was found (bsc#1194873).    \n- CVE-2021-43815: Fixed directory traversal for .csv files (bsc#1193686).    \n- CVE-2021-41244: Fixed incorrect access control vulnerability(bsc#1192763).    \n- CVE-2021-41174: Fixed XSS vulnerability on unauthenticated pages through interpolation binding expressions for AngularJS in URL (bsc#1192383).    \n- CVE-2021-3711: Fixed SM2 Decryption Buffer Overflow (bsc#1189520).    \n- CVE-2021-36222: Fixed a null pointer dereference in the KDC (bsc#1188571).    \n- CVE-2021-43798: Fixed arbitrary file read in the graph native plugin (bsc#1193492).  \n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "SUSE-2022-3676,SUSE-Storage-6-2022-3676",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/",
			"description": "Link for SUSE-SU-2022:3676-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012594.html",
			"description": "E-Mail link for SUSE-SU-2022:3676-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1188571",
			"description": "SUSE Bug 1188571"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1189520",
			"description": "SUSE Bug 1189520"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1192383",
			"description": "SUSE Bug 1192383"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1192763",
			"description": "SUSE Bug 1192763"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1193492",
			"description": "SUSE Bug 1193492"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1193686",
			"description": "SUSE Bug 1193686"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1194873",
			"description": "SUSE Bug 1194873"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1195726",
			"description": "SUSE Bug 1195726"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1195727",
			"description": "SUSE Bug 1195727"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1195728",
			"description": "SUSE Bug 1195728"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1201535",
			"description": "SUSE Bug 1201535"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1201539",
			"description": "SUSE Bug 1201539"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1203596",
			"description": "SUSE Bug 1203596"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1203597",
			"description": "SUSE Bug 1203597"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-36222/",
			"description": "SUSE CVE CVE-2021-36222 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-3711/",
			"description": "SUSE CVE CVE-2021-3711 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-41174/",
			"description": "SUSE CVE CVE-2021-41174 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-41244/",
			"description": "SUSE CVE CVE-2021-41244 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-43798/",
			"description": "SUSE CVE CVE-2021-43798 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-43815/",
			"description": "SUSE CVE CVE-2021-43815 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21673/",
			"description": "SUSE CVE CVE-2022-21673 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21702/",
			"description": "SUSE CVE CVE-2022-21702 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21703/",
			"description": "SUSE CVE CVE-2022-21703 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21713/",
			"description": "SUSE CVE CVE-2022-21713 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-31097/",
			"description": "SUSE CVE CVE-2022-31097 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-31107/",
			"description": "SUSE CVE CVE-2022-31107 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-35957/",
			"description": "SUSE CVE CVE-2022-35957 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-36062/",
			"description": "SUSE CVE CVE-2022-36062 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Enterprise Storage 6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Enterprise Storage 6",
						"full_product_name": {
							"text": "SUSE Enterprise Storage 6",
							"product_id": "SUSE Enterprise Storage 6",
							"cpe": "cpe:/o:suse:ses:6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "grafana-8.5.13-150100.3.12.1",
				"full_product_name": {
					"text": "grafana-8.5.13-150100.3.12.1",
					"product_id": "grafana-8.5.13-150100.3.12.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "grafana-8.5.13-150100.3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Enterprise Storage 6"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "ec_verify in kdc/kdc_preauth_ec.c in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.18.4 and 1.19.x before 1.19.2 allows remote attackers to cause a NULL pointer dereference and daemon crash. This occurs because a return value is not properly managed in a certain situation.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-36222",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:N/I:N/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.5",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-36222.html",
					"description": "CVE-2021-36222"
				},
				{
					"url": "https://bugzilla.suse.com/1188571",
					"description": "SUSE Bug 1188571"
				}
			]
		},
		{
			"notes": [
				{
					"text": "In order to decrypt SM2 encrypted data an application is expected to call the API function EVP_PKEY_decrypt(). Typically an application will call this function twice. The first time, on entry, the \"out\" parameter can be NULL and, on exit, the \"outlen\" parameter is populated with the buffer size required to hold the decrypted plaintext. The application can then allocate a sufficiently sized buffer and call EVP_PKEY_decrypt() again, but this time passing a non-NULL value for the \"out\" parameter. A bug in the implementation of the SM2 decryption code means that the calculation of the buffer size required to hold the plaintext returned by the first call to EVP_PKEY_decrypt() can be smaller than the actual size required by the second call. This can lead to a buffer overflow when EVP_PKEY_decrypt() is called by the application a second time with a buffer that is too small. A malicious attacker who is able present SM2 content for decryption to an application could cause attacker chosen data to overflow the buffer by up to a maximum of 62 bytes altering the contents of other data held after the buffer, possibly changing application behaviour or causing the application to crash. The location of the buffer is application dependent but is typically heap allocated. Fixed in OpenSSL 1.1.1l (Affected 1.1.1-1.1.1k).",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-3711",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "7.5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "9.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-3711.html",
					"description": "CVE-2021-3711"
				},
				{
					"url": "https://bugzilla.suse.com/1189520",
					"description": "SUSE Bug 1189520"
				},
				{
					"url": "https://bugzilla.suse.com/1190129",
					"description": "SUSE Bug 1190129"
				},
				{
					"url": "https://bugzilla.suse.com/1192100",
					"description": "SUSE Bug 1192100"
				},
				{
					"url": "https://bugzilla.suse.com/1205663",
					"description": "SUSE Bug 1205663"
				},
				{
					"url": "https://bugzilla.suse.com/1225628",
					"description": "SUSE Bug 1225628"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In affected versions if an attacker is able to convince a victim to visit a URL referencing a vulnerable page, arbitrary JavaScript content may be executed within the context of the victim's browser. The user visiting the malicious link must be unauthenticated and the link must be for a page that contains the login button in the menu bar. The url has to be crafted to exploit AngularJS rendering and contain the interpolation binding for AngularJS expressions. AngularJS uses double curly braces for interpolation binding: {{ }} ex: {{constructor.constructor('alert(1)')()}}. When the user follows the link and the page renders, the login button will contain the original link with a query parameter to force a redirect to the login page. The URL is not validated and the AngularJS rendering engine will execute the JavaScript expression contained in the URL. Users are advised to upgrade as soon as possible. If for some reason you cannot upgrade, you can use a reverse proxy or similar to block access to block the literal string {{ in the path.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-41174",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "6.9",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-41174.html",
					"description": "CVE-2021-41174"
				},
				{
					"url": "https://bugzilla.suse.com/1192383",
					"description": "SUSE Bug 1192383"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In affected versions when the fine-grained access control beta feature is enabled and there is more than one organization in the Grafana instance admins are able to access users from other organizations. Grafana 8.0 introduced a mechanism which allowed users with the Organization Admin role to list, add, remove, and update users' roles in other organizations in which they are not an admin. With fine-grained access control enabled, organization admins can list, add, remove and update users' roles in another organization, where they do not have organization admin role. All installations between v8.0 and v8.2.3 that have fine-grained access control beta enabled and more than one organization should be upgraded as soon as possible. If you cannot upgrade, you should turn off the fine-grained access control using a feature flag.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-41244",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.5",
					"vector_v_2": "AV:N/AC:L/Au:S/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "9.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-41244.html",
					"description": "CVE-2021-41244"
				},
				{
					"url": "https://bugzilla.suse.com/1192763",
					"description": "SUSE Bug 1192763"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Grafana versions 8.0.0-beta1 through 8.3.0 (except for patched versions) iss vulnerable to directory traversal, allowing access to local files. The vulnerable URL path is: `<grafana_host_url>/public/plugins//`, where is the plugin ID for any installed plugin. At no time has Grafana Cloud been vulnerable. Users are advised to upgrade to patched versions 8.0.7, 8.1.8, 8.2.7, or 8.3.1. The GitHub Security Advisory contains more information about vulnerable URL paths, mitigation, and the disclosure timeline.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-43798",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.5",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-43798.html",
					"description": "CVE-2021-43798"
				},
				{
					"url": "https://bugzilla.suse.com/1193492",
					"description": "SUSE Bug 1193492"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Grafana prior to versions 8.3.2 and 7.5.12 has a directory traversal for arbitrary .csv files. It only affects instances that have the developer testing tool called TestData DB data source enabled and configured. The vulnerability is limited in scope, and only allows access to files with the extension .csv to authenticated users only. Grafana Cloud instances have not been affected by the vulnerability. Versions 8.3.2 and 7.5.12 contain a patch for this issue. There is a workaround available for users who cannot upgrade. Running a reverse proxy in front of Grafana that normalizes the PATH of the request will mitigate the vulnerability. The proxy will have to also be able to handle url encoded paths.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-43815",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "3.5",
					"vector_v_2": "AV:N/AC:M/Au:S/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "4.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-43815.html",
					"description": "CVE-2021-43815"
				},
				{
					"url": "https://bugzilla.suse.com/1193686",
					"description": "SUSE Bug 1193686"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In affected versions when a data source has the Forward OAuth Identity feature enabled, sending a query to that datasource with an API token (and no other user credentials) will forward the OAuth Identity of the most recently logged-in user. This can allow API token holders to retrieve data for which they may not have intended access. This attack relies on the Grafana instance having data sources that support the Forward OAuth Identity feature, the Grafana instance having a data source with the Forward OAuth Identity feature toggled on, the Grafana instance having OAuth enabled, and the Grafana instance having usable API keys. This issue has been patched in versions 7.5.13 and 8.3.4.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21673",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "3.5",
					"vector_v_2": "AV:N/AC:M/Au:S/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "4.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21673.html",
					"description": "CVE-2022-21673"
				},
				{
					"url": "https://bugzilla.suse.com/1194873",
					"description": "SUSE Bug 1194873"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In affected versions an attacker could serve HTML content thru the Grafana datasource or plugin proxy and trick a user to visit this HTML page using a specially crafted link and execute a Cross-site Scripting (XSS) attack. The attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. To be impacted, all of the following must be applicable. For the data source proxy: A Grafana HTTP-based datasource configured with Server as Access Mode and a URL set, the attacker has to be in control of the HTTP server serving the URL of above datasource, and a specially crafted link pointing at the attacker controlled data source must be clicked on by an authenticated user. For the plugin proxy: A Grafana HTTP-based app plugin configured and enabled with a URL set, the attacker has to be in control of the HTTP server serving the URL of above app, and a specially crafted link pointing at the attacker controlled plugin must be clocked on by an authenticated user. For the backend plugin resource: An attacker must be able to navigate an authenticated user to a compromised plugin through a crafted link. Users are advised to update to a patched version. There are no known workarounds for this vulnerability.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21702",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "2.1",
					"vector_v_2": "AV:N/AC:H/Au:S/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21702.html",
					"description": "CVE-2022-21702"
				},
				{
					"url": "https://bugzilla.suse.com/1195726",
					"description": "SUSE Bug 1195726"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Affected versions are subject to a cross site request forgery vulnerability which allows attackers to elevate their privileges by mounting cross-origin attacks against authenticated high-privilege Grafana users (for example, Editors or Admins). An attacker can exploit this vulnerability for privilege escalation by tricking an authenticated user into inviting the attacker as a new user with high privileges. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21703",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.8",
					"vector_v_2": "AV:N/AC:M/Au:N/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21703.html",
					"description": "CVE-2022-21703"
				},
				{
					"url": "https://bugzilla.suse.com/1195727",
					"description": "SUSE Bug 1195727"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Affected versions of Grafana expose multiple API endpoints which do not properly handle user authorization. `/teams/:teamId` will allow an authenticated attacker to view unintended data by querying for the specific team ID, `/teams/:search` will allow an authenticated attacker to search for teams and see the total number of available teams, including for those teams that the user does not have access to, and `/teams/:teamId/members` when editors_can_admin flag is enabled, an authenticated attacker can see unintended data by querying for the specific team ID. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21713",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "3.5",
					"vector_v_2": "AV:N/AC:M/Au:S/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "4.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21713.html",
					"description": "CVE-2022-21713"
				},
				{
					"url": "https://bugzilla.suse.com/1195728",
					"description": "SUSE Bug 1195728"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Versions on the 8.x and 9.x branch prior to 9.0.3, 8.5.9, 8.4.10, and 8.3.10 are vulnerable to stored cross-site scripting via the Unified Alerting feature of Grafana. An attacker can exploit this vulnerability to escalate privilege from editor to admin by tricking an authenticated admin to click on a link. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch. As a workaround, it is possible to disable alerting or use legacy alerting.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-31097",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "7.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-31097.html",
					"description": "CVE-2022-31097"
				},
				{
					"url": "https://bugzilla.suse.com/1201535",
					"description": "SUSE Bug 1201535"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In versions 5.3 until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a malicious user who has authorization to log into a Grafana instance via a configured OAuth IdP which provides a login name to take over the account of another user in that Grafana instance. This can occur when the malicious user is authorized to log in to Grafana via OAuth, the malicious user's external user id is not already associated with an account in Grafana, the malicious user's email address is not already associated with an account in Grafana, and the malicious user knows the Grafana username of the target user. If these conditions are met, the malicious user can set their username in the OAuth provider to that of the target user, then go through the OAuth flow to log in to Grafana. Due to the way that external and internal user accounts are linked together during login, if the conditions above are all met then the malicious user will be able to log in to the target user's Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch for this issue. As a workaround, concerned users can disable OAuth login to their Grafana instance, or ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-31107",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "7.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-31107.html",
					"description": "CVE-2022-31107"
				},
				{
					"url": "https://bugzilla.suse.com/1201539",
					"description": "SUSE Bug 1201539"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Versions prior to 9.1.6 and 8.5.13 are vulnerable to an escalation from admin to server admin when auth proxy is used, allowing an admin to take over the server admin account and gain full control of the grafana instance. All installations should be upgraded as soon as possible. As a workaround deactivate auth proxy following the instructions at: https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/auth-proxy/",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-35957",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "6.6",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-35957.html",
					"description": "CVE-2022-35957"
				},
				{
					"url": "https://bugzilla.suse.com/1203597",
					"description": "SUSE Bug 1203597"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In versions prior to 8.5.13, 9.0.9, and 9.1.6, Grafana is subject to Improper Preservation of Permissions resulting in privilege escalation on some folders where Admin is the only used permission. The vulnerability impacts Grafana instances where RBAC was disabled and enabled afterwards, as the migrations which are translating legacy folder permissions to RBAC permissions do not account for the scenario where the only user permission in the folder is Admin, as a result RBAC adds permissions for Editors and Viewers which allow them to edit and view folders accordingly. This issue has been patched in versions 8.5.13, 9.0.9, and 9.1.6. A workaround when the impacted folder/dashboard is known is to remove the additional permissions manually.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-36062",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Enterprise Storage 6:grafana-8.5.13-150100.3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "6.4",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:L"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223676-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-36062.html",
					"description": "CVE-2022-36062"
				},
				{
					"url": "https://bugzilla.suse.com/1203596",
					"description": "SUSE Bug 1203596"
				}
			]
		}
	]
}
