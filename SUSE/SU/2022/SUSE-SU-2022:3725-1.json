{
	"document_title": "Security update for icinga2",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2022:3725-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2022-10-25T10:49:03Z",
				"description": "current"
			}
		},
		"initial_release_date": "2022-10-25T10:49:03Z",
		"current_release_date": "2022-10-25T10:49:03Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for icinga2",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for icinga2 fixes the following issues:\n\n- CVE-2020-14004: prepare-dirs script allows for symlink attack in the icinga user context. (bsc#1172171)\n- CVE-2020-29663: ignoring CRL, where revoked certificates due for renewal will automatically be renewed. (bsc#281137)\n- CVE-2021-37698: Missing TLS server certificate validation in ElasticsearchWriter, GelfWriter, InfluxdbWriter and Influxdb2Writer. (bsc#281137)\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "SUSE-2022-3725,SUSE-SLE-Module-HPC-12-2022-3725",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223725-1/",
			"description": "Link for SUSE-SU-2022:3725-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012665.html",
			"description": "E-Mail link for SUSE-SU-2022:3725-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1172171",
			"description": "SUSE Bug 1172171"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1180147",
			"description": "SUSE Bug 1180147"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1189653",
			"description": "SUSE Bug 1189653"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-14004/",
			"description": "SUSE CVE CVE-2020-14004 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-29663/",
			"description": "SUSE CVE CVE-2020-29663 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-37698/",
			"description": "SUSE CVE CVE-2021-37698 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Module for HPC 12",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for HPC 12",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for HPC 12",
							"product_id": "SUSE Linux Enterprise Module for HPC 12",
							"cpe": "cpe:/o:suse:sle-module-hpc:12"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "icinga2-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-2.8.2-3.6.1",
					"product_id": "icinga2-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "icinga2-bin-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-bin-2.8.2-3.6.1",
					"product_id": "icinga2-bin-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "icinga2-common-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-common-2.8.2-3.6.1",
					"product_id": "icinga2-common-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "icinga2-doc-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-doc-2.8.2-3.6.1",
					"product_id": "icinga2-doc-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "icinga2-ido-mysql-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-ido-mysql-2.8.2-3.6.1",
					"product_id": "icinga2-ido-mysql-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "icinga2-ido-pgsql-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-ido-pgsql-2.8.2-3.6.1",
					"product_id": "icinga2-ido-pgsql-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "icinga2-libs-2.8.2-3.6.1",
				"full_product_name": {
					"text": "icinga2-libs-2.8.2-3.6.1",
					"product_id": "icinga2-libs-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "nano-icinga2-2.8.2-3.6.1",
				"full_product_name": {
					"text": "nano-icinga2-2.8.2-3.6.1",
					"product_id": "nano-icinga2-2.8.2-3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "vim-icinga2-2.8.2-3.6.1",
				"full_product_name": {
					"text": "vim-icinga2-2.8.2-3.6.1",
					"product_id": "vim-icinga2-2.8.2-3.6.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "icinga2-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "icinga2-bin-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "icinga2-common-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "icinga2-doc-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "icinga2-ido-mysql-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "icinga2-ido-pgsql-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "icinga2-libs-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			},
			{
				"product_reference": "vim-icinga2-2.8.2-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for HPC 12"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "An issue was discovered in Icinga2 before v2.12.0-rc1. The prepare-dirs script (run as part of the icinga2 systemd service) executes chmod 2750 /run/icinga2/cmd. /run/icinga2 is under control of an unprivileged user by default. If /run/icinga2/cmd is a symlink, then it will by followed and arbitrary files can be changed to mode 2750 by the unprivileged icinga2 user.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-14004",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Module for HPC 12:icinga2-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-bin-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-common-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-doc-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-ido-mysql-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-ido-pgsql-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-libs-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:vim-icinga2-2.8.2-3.6.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4.6",
					"vector_v_2": "AV:L/AC:L/Au:N/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.8",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223725-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-14004.html",
					"description": "CVE-2020-14004"
				},
				{
					"url": "https://bugzilla.suse.com/1172171",
					"description": "SUSE Bug 1172171"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Icinga 2 v2.8.0 through v2.11.7 and v2.12.2 has an issue where revoked certificates due for renewal will automatically be renewed, ignoring the CRL. This issue is fixed in Icinga 2 v2.11.8 and v2.12.3.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-29663",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Module for HPC 12:icinga2-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-bin-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-common-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-doc-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-ido-mysql-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-ido-pgsql-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-libs-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:vim-icinga2-2.8.2-3.6.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.4",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223725-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-29663.html",
					"description": "CVE-2020-29663"
				},
				{
					"url": "https://bugzilla.suse.com/1180147",
					"description": "SUSE Bug 1180147"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Icinga is a monitoring system which checks the availability of network resources, notifies users of outages, and generates performance data for reporting. In versions 2.5.0 through 2.13.0, ElasticsearchWriter, GelfWriter, InfluxdbWriter and Influxdb2Writer do not verify the server's certificate despite a certificate authority being specified. Icinga 2 instances which connect to any of the mentioned time series databases (TSDBs) using TLS over a spoofable infrastructure should immediately upgrade to version 2.13.1, 2.12.6, or 2.11.11 to patch the issue. Such instances should also change the credentials (if any) used by the TSDB writer feature to authenticate against the TSDB. There are no workarounds aside from upgrading.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-37698",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Module for HPC 12:icinga2-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-bin-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-common-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-doc-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-ido-mysql-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-ido-pgsql-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:icinga2-libs-2.8.2-3.6.1",
						"SUSE Linux Enterprise Module for HPC 12:vim-icinga2-2.8.2-3.6.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223725-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-37698.html",
					"description": "CVE-2021-37698"
				},
				{
					"url": "https://bugzilla.suse.com/1189653",
					"description": "SUSE Bug 1189653"
				}
			]
		}
	]
}
