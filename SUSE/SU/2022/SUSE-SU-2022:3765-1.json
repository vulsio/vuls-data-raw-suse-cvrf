{
	"document_title": "Security update for grafana",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2022:3765-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2022-10-26T09:17:37Z",
				"description": "current"
			}
		},
		"initial_release_date": "2022-10-26T09:17:37Z",
		"current_release_date": "2022-10-26T09:17:37Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for grafana",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for grafana fixes the following issues:\n\n  Updated to version 8.3.10 (jsc#SLE-24565, jsc#SLE-23422, jsc#SLE-23439):\n\n  - CVE-2022-31097: Fixed XSS vulnerability in the Unified Alerting (bsc#1201535).\n  - CVE-2022-31107: Fixed OAuth account takeover vulnerability (bsc#1201539).\n  - CVE-2022-21702: Fixed XSS through attacker-controlled data source (bsc#1195726).\n  - CVE-2022-21703: Fixed Cross Site Request Forgery (bsc#1195727).\n  - CVE-2022-21713: Fixed Teams API IDOR (bsc#1195728).\n\n  ",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "Container ses/7.1/ceph/grafana:latest-2022-3765,SUSE-2022-3765,SUSE-SLE-Module-Packagehub-Subpackages-15-SP4-2022-3765,openSUSE-SLE-15.3-2022-3765,openSUSE-SLE-15.4-2022-3765",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223765-1/",
			"description": "Link for SUSE-SU-2022:3765-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012701.html",
			"description": "E-Mail link for SUSE-SU-2022:3765-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1195726",
			"description": "SUSE Bug 1195726"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1195727",
			"description": "SUSE Bug 1195727"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1195728",
			"description": "SUSE Bug 1195728"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1201535",
			"description": "SUSE Bug 1201535"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1201539",
			"description": "SUSE Bug 1201539"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21702/",
			"description": "SUSE CVE CVE-2022-21702 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21703/",
			"description": "SUSE CVE CVE-2022-21703 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-21713/",
			"description": "SUSE CVE CVE-2022-21713 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-31097/",
			"description": "SUSE CVE CVE-2022-31097 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2022-31107/",
			"description": "SUSE CVE CVE-2022-31107 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "Container ses/7.1/ceph/grafana:latest",
				"branch": [
					{
						"type": "Product Name",
						"name": "Container ses/7.1/ceph/grafana:latest",
						"full_product_name": {
							"text": "Container ses/7.1/ceph/grafana:latest",
							"product_id": "Container ses/7.1/ceph/grafana:latest"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Module for Package Hub 15 SP4",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Package Hub 15 SP4",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Package Hub 15 SP4",
							"product_id": "SUSE Linux Enterprise Module for Package Hub 15 SP4",
							"cpe": "cpe:/o:suse:packagehub:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.3",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.3",
						"full_product_name": {
							"text": "openSUSE Leap 15.3",
							"product_id": "openSUSE Leap 15.3",
							"cpe": "cpe:/o:opensuse:leap:15.3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.4",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.4",
						"full_product_name": {
							"text": "openSUSE Leap 15.4",
							"product_id": "openSUSE Leap 15.4",
							"cpe": "cpe:/o:opensuse:leap:15.4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "grafana-8.3.10-150200.3.26.1",
				"full_product_name": {
					"text": "grafana-8.3.10-150200.3.26.1",
					"product_id": "grafana-8.3.10-150200.3.26.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "grafana-8.3.10-150200.3.26.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Container ses/7.1/ceph/grafana:latest"
			},
			{
				"product_reference": "grafana-8.3.10-150200.3.26.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Package Hub 15 SP4"
			},
			{
				"product_reference": "grafana-8.3.10-150200.3.26.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			},
			{
				"product_reference": "grafana-8.3.10-150200.3.26.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In affected versions an attacker could serve HTML content thru the Grafana datasource or plugin proxy and trick a user to visit this HTML page using a specially crafted link and execute a Cross-site Scripting (XSS) attack. The attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. To be impacted, all of the following must be applicable. For the data source proxy: A Grafana HTTP-based datasource configured with Server as Access Mode and a URL set, the attacker has to be in control of the HTTP server serving the URL of above datasource, and a specially crafted link pointing at the attacker controlled data source must be clicked on by an authenticated user. For the plugin proxy: A Grafana HTTP-based app plugin configured and enabled with a URL set, the attacker has to be in control of the HTTP server serving the URL of above app, and a specially crafted link pointing at the attacker controlled plugin must be clocked on by an authenticated user. For the backend plugin resource: An attacker must be able to navigate an authenticated user to a compromised plugin through a crafted link. Users are advised to update to a patched version. There are no known workarounds for this vulnerability.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21702",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container ses/7.1/ceph/grafana:latest:grafana-8.3.10-150200.3.26.1",
						"SUSE Linux Enterprise Module for Package Hub 15 SP4:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.3:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.4:grafana-8.3.10-150200.3.26.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "2.1",
					"vector_v_2": "AV:N/AC:H/Au:S/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223765-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21702.html",
					"description": "CVE-2022-21702"
				},
				{
					"url": "https://bugzilla.suse.com/1195726",
					"description": "SUSE Bug 1195726"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Affected versions are subject to a cross site request forgery vulnerability which allows attackers to elevate their privileges by mounting cross-origin attacks against authenticated high-privilege Grafana users (for example, Editors or Admins). An attacker can exploit this vulnerability for privilege escalation by tricking an authenticated user into inviting the attacker as a new user with high privileges. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21703",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container ses/7.1/ceph/grafana:latest:grafana-8.3.10-150200.3.26.1",
						"SUSE Linux Enterprise Module for Package Hub 15 SP4:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.3:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.4:grafana-8.3.10-150200.3.26.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.8",
					"vector_v_2": "AV:N/AC:M/Au:N/C:P/I:P/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.8",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223765-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21703.html",
					"description": "CVE-2022-21703"
				},
				{
					"url": "https://bugzilla.suse.com/1195727",
					"description": "SUSE Bug 1195727"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Affected versions of Grafana expose multiple API endpoints which do not properly handle user authorization. `/teams/:teamId` will allow an authenticated attacker to view unintended data by querying for the specific team ID, `/teams/:search` will allow an authenticated attacker to search for teams and see the total number of available teams, including for those teams that the user does not have access to, and `/teams/:teamId/members` when editors_can_admin flag is enabled, an authenticated attacker can see unintended data by querying for the specific team ID. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-21713",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container ses/7.1/ceph/grafana:latest:grafana-8.3.10-150200.3.26.1",
						"SUSE Linux Enterprise Module for Package Hub 15 SP4:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.3:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.4:grafana-8.3.10-150200.3.26.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "3.5",
					"vector_v_2": "AV:N/AC:M/Au:S/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "4.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223765-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-21713.html",
					"description": "CVE-2022-21713"
				},
				{
					"url": "https://bugzilla.suse.com/1195728",
					"description": "SUSE Bug 1195728"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. Versions on the 8.x and 9.x branch prior to 9.0.3, 8.5.9, 8.4.10, and 8.3.10 are vulnerable to stored cross-site scripting via the Unified Alerting feature of Grafana. An attacker can exploit this vulnerability to escalate privilege from editor to admin by tricking an authenticated admin to click on a link. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch. As a workaround, it is possible to disable alerting or use legacy alerting.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-31097",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container ses/7.1/ceph/grafana:latest:grafana-8.3.10-150200.3.26.1",
						"SUSE Linux Enterprise Module for Package Hub 15 SP4:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.3:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.4:grafana-8.3.10-150200.3.26.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "7.3",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223765-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-31097.html",
					"description": "CVE-2022-31097"
				},
				{
					"url": "https://bugzilla.suse.com/1201535",
					"description": "SUSE Bug 1201535"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana is an open-source platform for monitoring and observability. In versions 5.3 until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a malicious user who has authorization to log into a Grafana instance via a configured OAuth IdP which provides a login name to take over the account of another user in that Grafana instance. This can occur when the malicious user is authorized to log in to Grafana via OAuth, the malicious user's external user id is not already associated with an account in Grafana, the malicious user's email address is not already associated with an account in Grafana, and the malicious user knows the Grafana username of the target user. If these conditions are met, the malicious user can set their username in the OAuth provider to that of the target user, then go through the OAuth flow to log in to Grafana. Due to the way that external and internal user accounts are linked together during login, if the conditions above are all met then the malicious user will be able to log in to the target user's Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch for this issue. As a workaround, concerned users can disable OAuth login to their Grafana instance, or ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-31107",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container ses/7.1/ceph/grafana:latest:grafana-8.3.10-150200.3.26.1",
						"SUSE Linux Enterprise Module for Package Hub 15 SP4:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.3:grafana-8.3.10-150200.3.26.1",
						"openSUSE Leap 15.4:grafana-8.3.10-150200.3.26.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "7.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2022/suse-su-20223765-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2022-31107.html",
					"description": "CVE-2022-31107"
				},
				{
					"url": "https://bugzilla.suse.com/1201539",
					"description": "SUSE Bug 1201539"
				}
			]
		}
	]
}
