{
	"document_title": "Security update for grafana and system-user-grafana",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2021:1233-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2021-04-15T15:21:15Z",
				"description": "current"
			}
		},
		"initial_release_date": "2021-04-15T15:21:15Z",
		"current_release_date": "2021-04-15T15:21:15Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for grafana and system-user-grafana",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for grafana and system-user-grafana fixes the following issues:\n\n- Updated grafana to upstream version 7.3.1\n  * CVE-2019-15043: In Grafana 2.x through 6.x before 6.3.4, parts of the HTTP API allow unauthenticated use.\n    This makes it possible to run a denial of service attack against the server running Grafana\n  * CVE-2020-12245: Grafana before 6.7.3 allows table-panel XSS via column.title or cellLinkTooltip (bsc#1170557)\n  * CVE-2020-13379: The avatar feature in Grafana 3.0.1 through 7.0.1 has an SSRF Incorrect Access Control issue.\n    This vulnerability allows any unauthenticated user/client to make Grafana send HTTP requests to any URL and\n    return its result to the user/client. This can be used to gain information about the network that Grafana is\n    running on. Furthermore, passing invalid URL objects could be used for DOS'ing Grafana via SegFault (bsc#1172409)\n  * CVE-2019-15043: In Grafana 2.x through 6.x before 6.3.4, parts of the HTTP API allow unauthenticated use.\n    This makes it possible to run a denial of service attack against the server running Grafana (bsc#1148383)\n  * CVE-2020-12052: Grafana version below 6.7.3 is vulnerable for annotation popup XSS (bsc#1170657)\n  * CVE-2020-24303: Grafana before 7.1.0-beta 1 allows XSS via a query alias for the ElasticSearch datasource. (bsc#1178243)\n  * CVE-2018-18623: Grafana 5.3.1 has XSS via the 'Dashboard > Text Panel' screen (bsc#1172450)\n  * CVE-2019-19499: Grafana versions below or equal to 6.4.3 has an Arbitrary File Read vulnerability, which\n    could be exploited by an authenticated attacker that has privileges to modify the data source configurations (bsc#1175951)\n\n  * Please refer to this package's changelog to get a full list of all changes (including bug fixes etc.)\n\n- Initial shipment of system-user-grafana to SES 6",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "Container caasp/v4/grafana:7.5.12-2021-1233,SUSE-2021-1233,SUSE-SLE-Manager-Tools-15-2021-1233,SUSE-Storage-6-2021-1233",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/",
			"description": "Link for SUSE-SU-2021:1233-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2021-April/008643.html",
			"description": "E-Mail link for SUSE-SU-2021:1233-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1148383",
			"description": "SUSE Bug 1148383"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1170557",
			"description": "SUSE Bug 1170557"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1170657",
			"description": "SUSE Bug 1170657"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1172409",
			"description": "SUSE Bug 1172409"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1172450",
			"description": "SUSE Bug 1172450"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1175951",
			"description": "SUSE Bug 1175951"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1178243",
			"description": "SUSE Bug 1178243"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2018-18623/",
			"description": "SUSE CVE CVE-2018-18623 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2019-15043/",
			"description": "SUSE CVE CVE-2019-15043 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2019-19499/",
			"description": "SUSE CVE CVE-2019-19499 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-12052/",
			"description": "SUSE CVE CVE-2020-12052 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-12245/",
			"description": "SUSE CVE CVE-2020-12245 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-13379/",
			"description": "SUSE CVE CVE-2020-13379 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-24303/",
			"description": "SUSE CVE CVE-2020-24303 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "Container caasp/v4/grafana:7.5.12",
				"branch": [
					{
						"type": "Product Name",
						"name": "Container caasp/v4/grafana:7.5.12",
						"full_product_name": {
							"text": "Container caasp/v4/grafana:7.5.12",
							"product_id": "Container caasp/v4/grafana:7.5.12"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Enterprise Storage 6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Enterprise Storage 6",
						"full_product_name": {
							"text": "SUSE Enterprise Storage 6",
							"product_id": "SUSE Enterprise Storage 6",
							"cpe": "cpe:/o:suse:ses:6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Manager Client Tools 15",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Manager Client Tools 15",
						"full_product_name": {
							"text": "SUSE Manager Client Tools 15",
							"product_id": "SUSE Manager Client Tools 15"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "system-user-grafana-1.0.0-3.9.1",
				"full_product_name": {
					"text": "system-user-grafana-1.0.0-3.9.1",
					"product_id": "system-user-grafana-1.0.0-3.9.1"
				}
			},
			{
				"type": "Product Version",
				"name": "grafana-7.3.1-3.6.1",
				"full_product_name": {
					"text": "grafana-7.3.1-3.6.1",
					"product_id": "grafana-7.3.1-3.6.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "system-user-grafana-1.0.0-3.9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Container caasp/v4/grafana:7.5.12"
			},
			{
				"product_reference": "grafana-7.3.1-3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Enterprise Storage 6"
			},
			{
				"product_reference": "system-user-grafana-1.0.0-3.9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Enterprise Storage 6"
			},
			{
				"product_reference": "system-user-grafana-1.0.0-3.9.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Manager Client Tools 15"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "Grafana 5.3.1 has XSS via the \"Dashboard > Text Panel\" screen. NOTE: this issue exists because of an incomplete fix for CVE-2018-12099.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2018-18623",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2018-18623.html",
					"description": "CVE-2018-18623"
				},
				{
					"url": "https://bugzilla.suse.com/1172450",
					"description": "SUSE Bug 1172450"
				},
				{
					"url": "https://bugzilla.suse.com/1174583",
					"description": "SUSE Bug 1174583"
				},
				{
					"url": "https://bugzilla.suse.com/1175951",
					"description": "SUSE Bug 1175951"
				}
			]
		},
		{
			"notes": [
				{
					"text": "In Grafana 2.x through 6.x before 6.3.4, parts of the HTTP API allow unauthenticated use. This makes it possible to run a denial of service attack against the server running Grafana.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2019-15043",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "5",
					"vector_v_2": "AV:N/AC:L/Au:N/C:N/I:N/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.1",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2019-15043.html",
					"description": "CVE-2019-15043"
				},
				{
					"url": "https://bugzilla.suse.com/1148383",
					"description": "SUSE Bug 1148383"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana <= 6.4.3 has an Arbitrary File Read vulnerability, which could be exploited by an authenticated attacker that has privileges to modify the data source configurations.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2019-19499",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4",
					"vector_v_2": "AV:N/AC:L/Au:S/C:P/I:N/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.5",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2019-19499.html",
					"description": "CVE-2019-19499"
				},
				{
					"url": "https://bugzilla.suse.com/1175951",
					"description": "SUSE Bug 1175951"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana version < 6.7.3 is vulnerable for annotation popup XSS.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-12052",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.4",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-12052.html",
					"description": "CVE-2020-12052"
				},
				{
					"url": "https://bugzilla.suse.com/1170657",
					"description": "SUSE Bug 1170657"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana before 6.7.3 allows table-panel XSS via column.title or cellLinkTooltip.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-12245",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "6.4",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-12245.html",
					"description": "CVE-2020-12245"
				},
				{
					"url": "https://bugzilla.suse.com/1170557",
					"description": "SUSE Bug 1170557"
				}
			]
		},
		{
			"notes": [
				{
					"text": "The avatar feature in Grafana 3.0.1 through 7.0.1 has an SSRF Incorrect Access Control issue. This vulnerability allows any unauthenticated user/client to make Grafana send HTTP requests to any URL and return its result to the user/client. This can be used to gain information about the network that Grafana is running on. Furthermore, passing invalid URL objects could be used for DOS'ing Grafana via SegFault.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-13379",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "6.4",
					"vector_v_2": "AV:N/AC:L/Au:N/C:P/I:N/A:P"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.5",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-13379.html",
					"description": "CVE-2020-13379"
				},
				{
					"url": "https://bugzilla.suse.com/1172409",
					"description": "SUSE Bug 1172409"
				}
			]
		},
		{
			"notes": [
				{
					"text": "Grafana before 7.1.0-beta 1 allows XSS via a query alias for the ElasticSearch datasource.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-24303",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container caasp/v4/grafana:7.5.12:system-user-grafana-1.0.0-3.9.1",
						"SUSE Enterprise Storage 6:grafana-7.3.1-3.6.1",
						"SUSE Enterprise Storage 6:system-user-grafana-1.0.0-3.9.1",
						"SUSE Manager Client Tools 15:system-user-grafana-1.0.0-3.9.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "4.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:N/I:P/A:N"
				},
				"score_set_v_3": {
					"base_score_v_3": "5.4",
					"vector_v_3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20211233-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-24303.html",
					"description": "CVE-2020-24303"
				},
				{
					"url": "https://bugzilla.suse.com/1178243",
					"description": "SUSE Bug 1178243"
				}
			]
		}
	]
}
