{
	"document_title": "Security Beta update for Salt",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2021:3906-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2021-12-03T11:04:20Z",
				"description": "current"
			}
		},
		"initial_release_date": "2021-12-03T11:04:20Z",
		"current_release_date": "2021-12-03T11:04:20Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security Beta update for Salt",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update fixes the following issues:\n\nsalt:\n\n- Remove wrong _parse_cpe_name from grains.core\n- Prevent tracebacks if directory for cookie is missing\n- Fix file.find tracebacks with non utf8 file names (bsc#1190114)\n- Fix ip6_interface grain to not leak secondary IPv4 aliases (bsc#1191412)\n- Do not consider skipped targets as failed for ansible.playbooks state (bsc#1190446)\n- Fix traceback.*_exc() calls\n- Fix the regression of docker_container state module\n- Support querying for JSON data in external sql pillar\n- Exclude the full path of a download URL to prevent injection of\n  malicious code (bsc#1190265) (CVE-2021-21996)\n- Fix wrong relative paths resolution with Jinja renderer when importing subdirectories\n- Fix python-MarkupSafe dependency (bsc#1189043)\n- Add missing aarch64 to rpm package architectures\n- Consolidate some state requisites (bsc#1188641)\n- Fix failing unit test for systemd\n- Fix error handling in openscap module (bsc#1188647)\n- Better handling of bad public keys from minions (bsc#1189040)\n- Define license macro as doc in spec file if not existing\n- Add standalone formulas configuration for salt minion and remove salt-master requirement (bsc#1168327)\n- Do noop for services states when running systemd in offline mode (bsc#1187787)\n- Transactional_updates: do not execute states in parallel but use a queue (bsc#1188170)\n- Handle 'master tops' data when states are applied by 'transactional_update' (bsc#1187787)\n- Enhance openscap module: add 'xccdf_eval' call\n- Virt: pass emulator when getting domain capabilities from libvirt\n- Implementation of held/unheld functions for state pkg (bsc#1187813)\n- Fix exception in yumpkg.remove for not installed package\n- Fix save for iptables state module (bsc#1185131)\n- Virt: use /dev/kvm to detect KVM\n- Zypperpkg: improve logic for handling vendorchange flags\n- Add bundled provides for tornado to the spec file\n- Enhance logging when inotify beacon is missing pyinotify (bsc#1186310)\n- Add 'python3-pyinotify' as a recommended package for Salt in SUSE/openSUSE distros\n- Check if dpkgnotify is executable (bsc#1186674)\n- Detect Python version to use inside container (bsc#1167586) (bsc#1164192)\n- Handle volumes on stopped pools in virt.vm_info (bsc#1186287)\n- Grains.extra: support old non-intel kernels (bsc#1180650)\n- Fix missing minion returns in batch mode (bsc#1184659)\n\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "SUSE-2021-3906,SUSE-SLE-Manager-Tools-12-BETA-2021-3906",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20213906-1/",
			"description": "Link for SUSE-SU-2021:3906-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2021-December/009824.html",
			"description": "E-Mail link for SUSE-SU-2021:3906-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1164192",
			"description": "SUSE Bug 1164192"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1167586",
			"description": "SUSE Bug 1167586"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1168327",
			"description": "SUSE Bug 1168327"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1180650",
			"description": "SUSE Bug 1180650"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1184659",
			"description": "SUSE Bug 1184659"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1185131",
			"description": "SUSE Bug 1185131"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1186287",
			"description": "SUSE Bug 1186287"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1186310",
			"description": "SUSE Bug 1186310"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1186674",
			"description": "SUSE Bug 1186674"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1187787",
			"description": "SUSE Bug 1187787"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1187813",
			"description": "SUSE Bug 1187813"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1188170",
			"description": "SUSE Bug 1188170"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1188641",
			"description": "SUSE Bug 1188641"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1188647",
			"description": "SUSE Bug 1188647"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1189040",
			"description": "SUSE Bug 1189040"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1189043",
			"description": "SUSE Bug 1189043"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1190114",
			"description": "SUSE Bug 1190114"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1190265",
			"description": "SUSE Bug 1190265"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1190446",
			"description": "SUSE Bug 1190446"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1191412",
			"description": "SUSE Bug 1191412"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-21996/",
			"description": "SUSE CVE CVE-2021-21996 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Version",
				"name": "python-Jinja2-2.8-22.5.1",
				"full_product_name": {
					"text": "python-Jinja2-2.8-22.5.1",
					"product_id": "python-Jinja2-2.8-22.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-Jinja2-emacs-2.8-22.5.1",
				"full_product_name": {
					"text": "python-Jinja2-emacs-2.8-22.5.1",
					"product_id": "python-Jinja2-emacs-2.8-22.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-Jinja2-vim-2.8-22.5.1",
				"full_product_name": {
					"text": "python-Jinja2-vim-2.8-22.5.1",
					"product_id": "python-Jinja2-vim-2.8-22.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-MarkupSafe-0.23-6.5.1",
				"full_product_name": {
					"text": "python-MarkupSafe-0.23-6.5.1",
					"product_id": "python-MarkupSafe-0.23-6.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-PyYAML-5.1.2-29.5.1",
				"full_product_name": {
					"text": "python-PyYAML-5.1.2-29.5.1",
					"product_id": "python-PyYAML-5.1.2-29.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-msgpack-python-0.4.6-11.5.1",
				"full_product_name": {
					"text": "python-msgpack-python-0.4.6-11.5.1",
					"product_id": "python-msgpack-python-0.4.6-11.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-psutil-5.2.2-18.5.1",
				"full_product_name": {
					"text": "python-psutil-5.2.2-18.5.1",
					"product_id": "python-psutil-5.2.2-18.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-pycrypto-2.6.1-13.5.1",
				"full_product_name": {
					"text": "python-pycrypto-2.6.1-13.5.1",
					"product_id": "python-pycrypto-2.6.1-13.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-pyzmq-14.0.0-12.5.1",
				"full_product_name": {
					"text": "python-pyzmq-14.0.0-12.5.1",
					"product_id": "python-pyzmq-14.0.0-12.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-pyzmq-devel-14.0.0-12.5.1",
				"full_product_name": {
					"text": "python-pyzmq-devel-14.0.0-12.5.1",
					"product_id": "python-pyzmq-devel-14.0.0-12.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python-singledispatch-3.4.0.3-4.8.1",
				"full_product_name": {
					"text": "python-singledispatch-3.4.0.3-4.8.1",
					"product_id": "python-singledispatch-3.4.0.3-4.8.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python2-salt-3000-49.38.2",
				"full_product_name": {
					"text": "python2-salt-3000-49.38.2",
					"product_id": "python2-salt-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-Jinja2-2.8-22.5.1",
				"full_product_name": {
					"text": "python3-Jinja2-2.8-22.5.1",
					"product_id": "python3-Jinja2-2.8-22.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-MarkupSafe-0.23-6.5.1",
				"full_product_name": {
					"text": "python3-MarkupSafe-0.23-6.5.1",
					"product_id": "python3-MarkupSafe-0.23-6.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-PyYAML-5.1.2-29.5.1",
				"full_product_name": {
					"text": "python3-PyYAML-5.1.2-29.5.1",
					"product_id": "python3-PyYAML-5.1.2-29.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-msgpack-python-0.4.6-11.5.1",
				"full_product_name": {
					"text": "python3-msgpack-python-0.4.6-11.5.1",
					"product_id": "python3-msgpack-python-0.4.6-11.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-psutil-5.2.2-18.5.1",
				"full_product_name": {
					"text": "python3-psutil-5.2.2-18.5.1",
					"product_id": "python3-psutil-5.2.2-18.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-pycrypto-2.6.1-13.5.1",
				"full_product_name": {
					"text": "python3-pycrypto-2.6.1-13.5.1",
					"product_id": "python3-pycrypto-2.6.1-13.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-pyzmq-14.0.0-12.5.1",
				"full_product_name": {
					"text": "python3-pyzmq-14.0.0-12.5.1",
					"product_id": "python3-pyzmq-14.0.0-12.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-pyzmq-devel-14.0.0-12.5.1",
				"full_product_name": {
					"text": "python3-pyzmq-devel-14.0.0-12.5.1",
					"product_id": "python3-pyzmq-devel-14.0.0-12.5.1"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-salt-3000-49.38.2",
				"full_product_name": {
					"text": "python3-salt-3000-49.38.2",
					"product_id": "python3-salt-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-3000-49.38.2",
				"full_product_name": {
					"text": "salt-3000-49.38.2",
					"product_id": "salt-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-api-3000-49.38.2",
				"full_product_name": {
					"text": "salt-api-3000-49.38.2",
					"product_id": "salt-api-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-bash-completion-3000-49.38.2",
				"full_product_name": {
					"text": "salt-bash-completion-3000-49.38.2",
					"product_id": "salt-bash-completion-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-cloud-3000-49.38.2",
				"full_product_name": {
					"text": "salt-cloud-3000-49.38.2",
					"product_id": "salt-cloud-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-doc-3000-49.38.2",
				"full_product_name": {
					"text": "salt-doc-3000-49.38.2",
					"product_id": "salt-doc-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-fish-completion-3000-49.38.2",
				"full_product_name": {
					"text": "salt-fish-completion-3000-49.38.2",
					"product_id": "salt-fish-completion-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-master-3000-49.38.2",
				"full_product_name": {
					"text": "salt-master-3000-49.38.2",
					"product_id": "salt-master-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-minion-3000-49.38.2",
				"full_product_name": {
					"text": "salt-minion-3000-49.38.2",
					"product_id": "salt-minion-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-proxy-3000-49.38.2",
				"full_product_name": {
					"text": "salt-proxy-3000-49.38.2",
					"product_id": "salt-proxy-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-ssh-3000-49.38.2",
				"full_product_name": {
					"text": "salt-ssh-3000-49.38.2",
					"product_id": "salt-ssh-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-standalone-formulas-configuration-3000-49.38.2",
				"full_product_name": {
					"text": "salt-standalone-formulas-configuration-3000-49.38.2",
					"product_id": "salt-standalone-formulas-configuration-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-syndic-3000-49.38.2",
				"full_product_name": {
					"text": "salt-syndic-3000-49.38.2",
					"product_id": "salt-syndic-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-transactional-update-3000-49.38.2",
				"full_product_name": {
					"text": "salt-transactional-update-3000-49.38.2",
					"product_id": "salt-transactional-update-3000-49.38.2"
				}
			},
			{
				"type": "Product Version",
				"name": "salt-zsh-completion-3000-49.38.2",
				"full_product_name": {
					"text": "salt-zsh-completion-3000-49.38.2",
					"product_id": "salt-zsh-completion-3000-49.38.2"
				}
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "An issue was discovered in SaltStack Salt before 3003.3. A user who has control of the source, and source_hash URLs can gain full file system access as root on a salt minion.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-21996",
			"product_statuses": [
				{
					"type": "Fixed"
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "7.1",
					"vector_v_2": "AV:N/AC:H/Au:S/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "4.2",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20213906-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-21996.html",
					"description": "CVE-2021-21996"
				},
				{
					"url": "https://bugzilla.suse.com/1190265",
					"description": "SUSE Bug 1190265"
				},
				{
					"url": "https://bugzilla.suse.com/1210934",
					"description": "SUSE Bug 1210934"
				}
			]
		}
	]
}
