{
	"document_title": "Security update for rubygem-bundler",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2024:3873-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2024-11-01T15:22:19Z",
				"description": "current"
			}
		},
		"initial_release_date": "2024-11-01T15:22:19Z",
		"current_release_date": "2024-11-01T15:22:19Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for rubygem-bundler",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for rubygem-bundler fixes the following issues:\n\n- CVE-2021-43809: Fixed remote execution via Gemfile argument injection (bsc#1193578)\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "Container bci/ruby:latest-2024-3873,Container suse/rmt-server:latest-2024-3873,SUSE-2024-3873,SUSE-SLE-Module-Basesystem-15-SP5-2024-3873,SUSE-SLE-Module-Basesystem-15-SP6-2024-3873,SUSE-SLE-Product-SLED-15-SP4-LTSS-2024-3873,SUSE-SLE-Product-SLES-15-SP2-LTSS-2024-3873,SUSE-SLE-Product-SLES-15-SP3-LTSS-2024-3873,SUSE-SLE-Product-SLES-15-SP4-LTSS-2024-3873,SUSE-SLE-Product-SLES_SAP-15-SP2-2024-3873,SUSE-SLE-Product-SLES_SAP-15-SP3-2024-3873,SUSE-SLE-Product-SUSE-Manager-Server-4.3-2024-3873,openSUSE-SLE-15.5-2024-3873",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2024/suse-su-20243873-1/",
			"description": "Link for SUSE-SU-2024:3873-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019757.html",
			"description": "E-Mail link for SUSE-SU-2024:3873-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1193578",
			"description": "SUSE Bug 1193578"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-43809/",
			"description": "SUSE CVE CVE-2021-43809 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "Container bci/ruby:latest",
				"branch": [
					{
						"type": "Product Name",
						"name": "Container bci/ruby:latest",
						"full_product_name": {
							"text": "Container bci/ruby:latest",
							"product_id": "Container bci/ruby:latest"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Container suse/rmt-server:latest",
				"branch": [
					{
						"type": "Product Name",
						"name": "Container suse/rmt-server:latest",
						"full_product_name": {
							"text": "Container suse/rmt-server:latest",
							"product_id": "Container suse/rmt-server:latest"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Basesystem 15 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Basesystem 15 SP5",
							"product_id": "SUSE Linux Enterprise Module for Basesystem 15 SP5",
							"cpe": "cpe:/o:suse:sle-module-basesystem:15:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Module for Basesystem 15 SP6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Basesystem 15 SP6",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Basesystem 15 SP6",
							"product_id": "SUSE Linux Enterprise Module for Basesystem 15 SP6",
							"cpe": "cpe:/o:suse:sle-module-basesystem:15:sp6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP2-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP2-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP2-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP2-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp2"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP3-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP3-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP3-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP3-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP4-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP4-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP4-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP4-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
							"cpe": "cpe:/o:suse:sles_sap:15:sp2"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
							"cpe": "cpe:/o:suse:sles_sap:15:sp3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Manager Server 4.3",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Manager Server 4.3",
						"full_product_name": {
							"text": "SUSE Manager Server 4.3",
							"product_id": "SUSE Manager Server 4.3",
							"cpe": "cpe:/o:suse:suse-manager-server:4.3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.5",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.5",
						"full_product_name": {
							"text": "openSUSE Leap 15.5",
							"product_id": "openSUSE Leap 15.5",
							"cpe": "cpe:/o:opensuse:leap:15.5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"full_product_name": {
					"text": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
					"product_id": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "ruby2.5-rubygem-bundler-doc-1.16.1-150000.3.6.1",
				"full_product_name": {
					"text": "ruby2.5-rubygem-bundler-doc-1.16.1-150000.3.6.1",
					"product_id": "ruby2.5-rubygem-bundler-doc-1.16.1-150000.3.6.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Container bci/ruby:latest"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Container suse/rmt-server:latest"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Basesystem 15 SP5"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Basesystem 15 SP6"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Manager Server 4.3"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "ruby2.5-rubygem-bundler-doc-1.16.1-150000.3.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "`Bundler` is a package for managing application dependencies in Ruby. In `bundler` versions before 2.2.33, when working with untrusted and apparently harmless `Gemfile`'s, it is not expected that they lead to execution of external code, unless that's explicit in the ruby code inside the `Gemfile` itself. However, if the `Gemfile` includes `gem` entries that use the `git` option with invalid, but seemingly harmless, values with a leading dash, this can be false. To handle dependencies that come from a Git repository instead of a registry, Bundler uses various commands, such as `git clone`. These commands are being constructed using user input (e.g. the repository URL). When building the commands, Bundler versions before 2.2.33 correctly avoid Command Injection vulnerabilities by passing an array of arguments instead of a command string. However, there is the possibility that a user input starts with a dash (`-`) and is therefore treated as an optional argument instead of a positional one. This can lead to Code Execution because some of the commands have options that can be leveraged to run arbitrary executables. Since this value comes from the `Gemfile` file, it can contain any character, including a leading dash.\n\nTo exploit this vulnerability, an attacker has to craft a directory containing a `Gemfile` file that declares a dependency that is located in a Git repository. This dependency has to have a Git URL in the form of `-u./payload`. This URL will be used to construct a Git clone command but will be interpreted as the upload-pack argument. Then this directory needs to be shared with the victim, who then needs to run a command that evaluates the Gemfile, such as `bundle lock`, inside.\n\nThis vulnerability can lead to Arbitrary Code Execution, which could potentially lead to the takeover of the system. However, the exploitability is very low, because it requires a lot of user interaction. Bundler 2.2.33 has patched this problem by inserting `--` as an argument before any positional arguments to those Git commands that were affected by this issue. Regardless of whether users can upgrade or not, they should review any untrustred `Gemfile`'s before running any `bundler` commands that may read them, since they can contain arbitrary ruby code.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-43809",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Container bci/ruby:latest:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"Container suse/rmt-server:latest:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Module for Basesystem 15 SP5:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Module for Basesystem 15 SP6:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Server 15 SP2-LTSS:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Server 15 SP3-LTSS:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Server 15 SP4-LTSS:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Server for SAP Applications 15 SP2:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Linux Enterprise Server for SAP Applications 15 SP3:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"SUSE Manager Server 4.3:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"openSUSE Leap 15.5:ruby2.5-rubygem-bundler-1.16.1-150000.3.6.1",
						"openSUSE Leap 15.5:ruby2.5-rubygem-bundler-doc-1.16.1-150000.3.6.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "9.3",
					"vector_v_2": "AV:N/AC:M/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.3",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2024/suse-su-20243873-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-43809.html",
					"description": "CVE-2021-43809"
				},
				{
					"url": "https://bugzilla.suse.com/1193578",
					"description": "SUSE Bug 1193578"
				}
			]
		}
	]
}
