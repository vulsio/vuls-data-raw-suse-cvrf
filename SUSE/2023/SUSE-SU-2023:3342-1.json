{
	"document_title": "Security update for postgresql15",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2023:3342-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2023-08-17T11:57:02Z",
				"description": "current"
			}
		},
		"initial_release_date": "2023-08-17T11:57:02Z",
		"current_release_date": "2023-08-17T11:57:02Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for postgresql15",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for postgresql15 fixes the following issues:\n\n- Update to 15.4\n- CVE-2023-39417: Fixed potential SQL injection for trusted extensions. (bsc#1214059)\n- CVE-2023-39418: Fix MERGE to enforce row security. (bsc#1214061)\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "SUSE-2023-3342,SUSE-SLE-SDK-12-SP5-2023-3342,SUSE-SLE-SERVER-12-SP5-2023-3342",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20233342-1/",
			"description": "Link for SUSE-SU-2023:3342-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2023-August/015941.html",
			"description": "E-Mail link for SUSE-SU-2023:3342-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1214059",
			"description": "SUSE Bug 1214059"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1214061",
			"description": "SUSE Bug 1214061"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2023-39417/",
			"description": "SUSE CVE CVE-2023-39417 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2023-39418/",
			"description": "SUSE CVE CVE-2023-39418 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 12 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 12 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 12 SP5",
							"product_id": "SUSE Linux Enterprise Server 12 SP5",
							"cpe": "cpe:/o:suse:sles:12:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
							"cpe": "cpe:/o:suse:sles_sap:12:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Software Development Kit 12 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Software Development Kit 12 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Software Development Kit 12 SP5",
							"product_id": "SUSE Linux Enterprise Software Development Kit 12 SP5",
							"cpe": "cpe:/o:suse:sle-sdk:12:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "libecpg6-15.4-3.12.1",
				"full_product_name": {
					"text": "libecpg6-15.4-3.12.1",
					"product_id": "libecpg6-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libecpg6-32bit-15.4-3.12.1",
				"full_product_name": {
					"text": "libecpg6-32bit-15.4-3.12.1",
					"product_id": "libecpg6-32bit-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libecpg6-64bit-15.4-3.12.1",
				"full_product_name": {
					"text": "libecpg6-64bit-15.4-3.12.1",
					"product_id": "libecpg6-64bit-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libpq5-15.4-3.12.1",
				"full_product_name": {
					"text": "libpq5-15.4-3.12.1",
					"product_id": "libpq5-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libpq5-32bit-15.4-3.12.1",
				"full_product_name": {
					"text": "libpq5-32bit-15.4-3.12.1",
					"product_id": "libpq5-32bit-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "libpq5-64bit-15.4-3.12.1",
				"full_product_name": {
					"text": "libpq5-64bit-15.4-3.12.1",
					"product_id": "libpq5-64bit-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-15.4-3.12.1",
					"product_id": "postgresql15-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-contrib-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-contrib-15.4-3.12.1",
					"product_id": "postgresql15-contrib-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-devel-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-devel-15.4-3.12.1",
					"product_id": "postgresql15-devel-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-devel-mini-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-devel-mini-15.4-3.12.1",
					"product_id": "postgresql15-devel-mini-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-docs-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-docs-15.4-3.12.1",
					"product_id": "postgresql15-docs-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-llvmjit-devel-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-llvmjit-devel-15.4-3.12.1",
					"product_id": "postgresql15-llvmjit-devel-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-plperl-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-plperl-15.4-3.12.1",
					"product_id": "postgresql15-plperl-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-plpython-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-plpython-15.4-3.12.1",
					"product_id": "postgresql15-plpython-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-pltcl-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-pltcl-15.4-3.12.1",
					"product_id": "postgresql15-pltcl-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-server-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-server-15.4-3.12.1",
					"product_id": "postgresql15-server-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-server-devel-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-server-devel-15.4-3.12.1",
					"product_id": "postgresql15-server-devel-15.4-3.12.1"
				}
			},
			{
				"type": "Product Version",
				"name": "postgresql15-test-15.4-3.12.1",
				"full_product_name": {
					"text": "postgresql15-test-15.4-3.12.1",
					"product_id": "postgresql15-test-15.4-3.12.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "libecpg6-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "libecpg6-32bit-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "libpq5-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "libpq5-32bit-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-contrib-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-docs-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-plperl-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-plpython-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-pltcl-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "postgresql15-server-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "libecpg6-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "libecpg6-32bit-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "libpq5-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "libpq5-32bit-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-contrib-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-docs-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-plperl-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-plpython-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-pltcl-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-server-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "postgresql15-devel-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Software Development Kit 12 SP5"
			},
			{
				"product_reference": "postgresql15-server-devel-15.4-3.12.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Software Development Kit 12 SP5"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "IN THE EXTENSION SCRIPT, a SQL Injection vulnerability was found in PostgreSQL if it uses @extowner@, @extschema@, or @extschema:...@ inside a quoting construct (dollar quoting, '', or \"\"). If an administrator has installed files of a vulnerable, trusted, non-bundled extension, an attacker with database-level CREATE privilege can execute arbitrary code as the bootstrap superuser.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2023-39417",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Server 12 SP5:libecpg6-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:libecpg6-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:libpq5-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:libpq5-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-contrib-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-docs-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-plperl-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-plpython-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-pltcl-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-server-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libecpg6-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libecpg6-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libpq5-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libpq5-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-contrib-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-docs-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-plperl-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-plpython-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-pltcl-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-server-15.4-3.12.1",
						"SUSE Linux Enterprise Software Development Kit 12 SP5:postgresql15-devel-15.4-3.12.1",
						"SUSE Linux Enterprise Software Development Kit 12 SP5:postgresql15-server-devel-15.4-3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "6.3",
					"vector_v_3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20233342-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2023-39417.html",
					"description": "CVE-2023-39417"
				},
				{
					"url": "https://bugzilla.suse.com/1214059",
					"description": "SUSE Bug 1214059"
				}
			]
		},
		{
			"notes": [
				{
					"text": "A vulnerability was found in PostgreSQL with the use of the MERGE command, which fails to test new rows against row security policies defined for UPDATE and SELECT. If UPDATE and SELECT policies forbid some rows that INSERT policies do not forbid, a user could store such rows.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2023-39418",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Linux Enterprise Server 12 SP5:libecpg6-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:libecpg6-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:libpq5-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:libpq5-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-contrib-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-docs-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-plperl-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-plpython-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-pltcl-15.4-3.12.1",
						"SUSE Linux Enterprise Server 12 SP5:postgresql15-server-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libecpg6-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libecpg6-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libpq5-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:libpq5-32bit-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-contrib-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-docs-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-plperl-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-plpython-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-pltcl-15.4-3.12.1",
						"SUSE Linux Enterprise Server for SAP Applications 12 SP5:postgresql15-server-15.4-3.12.1",
						"SUSE Linux Enterprise Software Development Kit 12 SP5:postgresql15-devel-15.4-3.12.1",
						"SUSE Linux Enterprise Software Development Kit 12 SP5:postgresql15-server-devel-15.4-3.12.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "moderate"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "4.7",
					"vector_v_3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2023/suse-su-20233342-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2023-39418.html",
					"description": "CVE-2023-39418"
				},
				{
					"url": "https://bugzilla.suse.com/1214061",
					"description": "SUSE Bug 1214061"
				}
			]
		}
	]
}
