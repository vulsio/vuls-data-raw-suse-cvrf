{
	"document_title": "Security update for crmsh",
	"document_type": "SUSE Patch",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE-SU-2021:0806-1"
		},
		"status": "Final",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2021-03-17T16:09:38Z",
				"description": "current"
			}
		},
		"initial_release_date": "2021-03-17T16:09:38Z",
		"current_release_date": "2021-03-17T16:09:38Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf.pl",
			"date": "2017-02-24T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "Security update for crmsh",
			"title": "Topic",
			"type": "Summary"
		},
		{
			"text": "This update for crmsh fixes the following issues:\n\n- Update to version 4.3.0+20210219.5d1bf034:\n  * Fix: hb_report: walk through hb_report process under hacluster(CVE-2020-35459, bsc#1179999; CVE-2021-3020, bsc#1180571)\n  * Fix: bootstrap: setup authorized ssh access for hacluster(CVE-2020-35459, bsc#1179999; CVE-2021-3020, bsc#1180571)\n  * Dev: analyze: Add analyze sublevel and put preflight_check in it(jsc#ECO-1658)\n  * Dev: utils: change default file mod as 644 for str2file function\n  * Dev: hb_report: Detect if any ocfs2 partitions exist\n  * Dev: lock: give more specific error message when raise ClaimLockError\n  * Fix: Replace mktemp() to mkstemp() for security\n  * Fix: Remove the duplicate --cov-report html in tox.\n  * Fix: fix some lint issues.\n  * Fix: Replace utils.msg_info to task.info\n  * Fix: Solve a circular import error of utils.py\n  * Fix: hb_report: run lsof with specific ocfs2 device(bsc#1180688)\n  * Dev: corosync: change the permission of corosync.conf to 644\n  * Fix: preflight_check: task: raise error when report_path isn't a directory\n  * Fix: bootstrap: Use class Watchdog to simplify watchdog config(bsc#1154927, bsc#1178869)\n  * Dev: Polish the sbd feature.\n  * Dev: Replace -f with -c and run check when no parameter provide.\n  * Fix: Fix the yes option not working\n  * Fix: Remove useless import and show help when no input.\n  * Dev: Correct SBD device id inconsistenc during ASR\n  * Fix: completers: return complete start/stop resource id list correctly(bsc#1180137)\n  * Dev: Makefile.am: change makefile to integrate preflight_check\n  * Medium: integrate preflight_check into crmsh(jsc#ECO-1658)\n  * Fix: bootstrap: make sure sbd device UUID was the same between nodes(bsc#1178454)\n",
			"title": "Details",
			"type": "General"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		},
		{
			"text": "Image SLES15-SAP-Azure-2021-806,Image SLES15-SAP-Azure-BYOS-2021-806,Image SLES15-SAP-Azure-LI-BYOS-Production-2021-806,Image SLES15-SAP-Azure-VLI-BYOS-Production-2021-806,Image SLES15-SAP-EC2-HVM-2021-806,Image SLES15-SAP-EC2-HVM-BYOS-2021-806,Image SLES15-SAP-GCE-2021-806,Image SLES15-SAP-GCE-BYOS-2021-806,SUSE-2021-806,SUSE-SLE-Product-HA-15-2021-806",
			"title": "Patchnames",
			"type": "Details"
		}
	],
	"documentdistribution": "Copyright SUSE LLC under the Creative Commons License 4.0 with Attribution (CC-BY-4.0)",
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20210806-1/",
			"description": "Link for SUSE-SU-2021:0806-1"
		},
		{
			"type": "Self",
			"url": "https://lists.suse.com/pipermail/sle-security-updates/2021-March/008511.html",
			"description": "E-Mail link for SUSE-SU-2021:0806-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1154927",
			"description": "SUSE Bug 1154927"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1178454",
			"description": "SUSE Bug 1178454"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1178869",
			"description": "SUSE Bug 1178869"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1179999",
			"description": "SUSE Bug 1179999"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1180137",
			"description": "SUSE Bug 1180137"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1180571",
			"description": "SUSE Bug 1180571"
		},
		{
			"type": "Self",
			"url": "https://bugzilla.suse.com/1180688",
			"description": "SUSE Bug 1180688"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2020-35459/",
			"description": "SUSE CVE CVE-2020-35459 page"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/security/cve/CVE-2021-3020/",
			"description": "SUSE CVE CVE-2021-3020 page"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-Azure",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-Azure",
						"full_product_name": {
							"text": "Image SLES15-SAP-Azure",
							"product_id": "Image SLES15-SAP-Azure"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-Azure-BYOS",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-Azure-BYOS",
						"full_product_name": {
							"text": "Image SLES15-SAP-Azure-BYOS",
							"product_id": "Image SLES15-SAP-Azure-BYOS"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-Azure-LI-BYOS-Production",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-Azure-LI-BYOS-Production",
						"full_product_name": {
							"text": "Image SLES15-SAP-Azure-LI-BYOS-Production",
							"product_id": "Image SLES15-SAP-Azure-LI-BYOS-Production"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-Azure-VLI-BYOS-Production",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-Azure-VLI-BYOS-Production",
						"full_product_name": {
							"text": "Image SLES15-SAP-Azure-VLI-BYOS-Production",
							"product_id": "Image SLES15-SAP-Azure-VLI-BYOS-Production"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-EC2-HVM",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-EC2-HVM",
						"full_product_name": {
							"text": "Image SLES15-SAP-EC2-HVM",
							"product_id": "Image SLES15-SAP-EC2-HVM"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-EC2-HVM-BYOS",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-EC2-HVM-BYOS",
						"full_product_name": {
							"text": "Image SLES15-SAP-EC2-HVM-BYOS",
							"product_id": "Image SLES15-SAP-EC2-HVM-BYOS"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-GCE",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-GCE",
						"full_product_name": {
							"text": "Image SLES15-SAP-GCE",
							"product_id": "Image SLES15-SAP-GCE"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "Image SLES15-SAP-GCE-BYOS",
				"branch": [
					{
						"type": "Product Name",
						"name": "Image SLES15-SAP-GCE-BYOS",
						"full_product_name": {
							"text": "Image SLES15-SAP-GCE-BYOS",
							"product_id": "Image SLES15-SAP-GCE-BYOS"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Availability Extension 15",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise High Availability Extension 15",
						"full_product_name": {
							"text": "SUSE Linux Enterprise High Availability Extension 15",
							"product_id": "SUSE Linux Enterprise High Availability Extension 15",
							"cpe": "cpe:/o:suse:sle-ha:15"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"full_product_name": {
					"text": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
					"product_id": "crmsh-4.3.0+20210219.5d1bf034-3.62.3"
				}
			},
			{
				"type": "Product Version",
				"name": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"full_product_name": {
					"text": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
					"product_id": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3"
				}
			},
			{
				"type": "Product Version",
				"name": "crmsh-test-4.3.0+20210219.5d1bf034-3.62.3",
				"full_product_name": {
					"text": "crmsh-test-4.3.0+20210219.5d1bf034-3.62.3",
					"product_id": "crmsh-test-4.3.0+20210219.5d1bf034-3.62.3"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure-BYOS"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure-BYOS"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure-LI-BYOS-Production"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure-LI-BYOS-Production"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure-VLI-BYOS-Production"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-Azure-VLI-BYOS-Production"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-EC2-HVM"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-EC2-HVM"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-EC2-HVM-BYOS"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-EC2-HVM-BYOS"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-GCE"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-GCE"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-GCE-BYOS"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "Image SLES15-SAP-GCE-BYOS"
			},
			{
				"product_reference": "crmsh-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Availability Extension 15"
			},
			{
				"product_reference": "crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Availability Extension 15"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "An issue was discovered in ClusterLabs crmsh through 4.2.1. Local attackers able to call \"crm history\" (when \"crm\" is run) were able to execute commands via shell code injection to the crm history commandline, potentially allowing escalation of privileges.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2020-35459",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Image SLES15-SAP-Azure-BYOS:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-BYOS:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-LI-BYOS-Production:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-LI-BYOS-Production:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-VLI-BYOS-Production:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-VLI-BYOS-Production:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM-BYOS:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM-BYOS:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE-BYOS:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE-BYOS:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"SUSE Linux Enterprise High Availability Extension 15:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"SUSE Linux Enterprise High Availability Extension 15:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "7.2",
					"vector_v_2": "AV:L/AC:L/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "8.4",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20210806-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2020-35459.html",
					"description": "CVE-2020-35459"
				},
				{
					"url": "https://bugzilla.suse.com/1179999",
					"description": "SUSE Bug 1179999"
				}
			]
		},
		{
			"notes": [
				{
					"text": "An issue was discovered in ClusterLabs Hawk (aka HA Web Konsole) through 2.3.0-15. It ships the binary hawk_invoke (built from tools/hawk_invoke.c), intended to be used as a setuid program. This allows the hacluster user to invoke certain commands as root (with an attempt to limit this to safe combinations). This user is able to execute an interactive \"shell\" that isn't limited to the commands specified in hawk_invoke, allowing escalation to root.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2021-3020",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"Image SLES15-SAP-Azure-BYOS:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-BYOS:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-LI-BYOS-Production:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-LI-BYOS-Production:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-VLI-BYOS-Production:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure-VLI-BYOS-Production:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-Azure:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM-BYOS:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM-BYOS:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-EC2-HVM:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE-BYOS:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE-BYOS:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"Image SLES15-SAP-GCE:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3",
						"SUSE Linux Enterprise High Availability Extension 15:crmsh-4.3.0+20210219.5d1bf034-3.62.3",
						"SUSE Linux Enterprise High Availability Extension 15:crmsh-scripts-4.3.0+20210219.5d1bf034-3.62.3"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "8.4",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
				},
				"scoreset": {}
			},
			"remediations": [
				{
					"type": "Vendor Fix",
					"description": {
						"text": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
						"lang": "en"
					},
					"url": "https://www.suse.com/support/update/announcement/2021/suse-su-20210806-1/"
				}
			],
			"references": [
				{
					"url": "https://www.suse.com/security/cve/CVE-2021-3020.html",
					"description": "CVE-2021-3020"
				},
				{
					"url": "https://bugzilla.suse.com/1180571",
					"description": "SUSE Bug 1180571"
				}
			]
		}
	]
}
